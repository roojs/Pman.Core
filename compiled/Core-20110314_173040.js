if (typeof(_T) == 'undefined') { _T={};}
_T["daed45fe377199115ee46b87eb340dcc"]="Edit Companies";
_T["e35c34d957d7aebd0c9e37aa77f50b70"]="Cancel";
_T["59c001255d821a2e12e8fb705dba9fea"]="Save";
_T["5f679f3c301a24b3f538a9766ee3ae6e"]="Loading";
_T["1f0d43f377b93713beb48cbaca0e4401"]="Your Company Details";
_T["4cf24f0f74944b39fd350182d5e15817"]="Edit Company";
_T["ce9ba64bb3f29723e000efb2e80abb8e"]="Add Company";
_T["650deecbb5e829066db9b03be1125a1c"]="Consultant";
_T["59bfcea58d8c79f4a8cc2ce8256a167a"]="Client";
_T["692e49978c615ffee8b37ed3a8ef2a12"]="Contractor";
_T["e3aa17d446c7005272762934b3b1e1a0"]="OWNER";
_T["3fbd4316b2e824257633036893085545"]="System Owner";
_T["857adf078513b5f11f815595aa0f9fd1"]="Company ID (for filing Ref.)";
_T["75d069b37c5159f5acb5d01d10a2d9a3"]="Enter code";
_T["81cbd120755795f72b127151e540cde5"]="Select Type";
_T["37b6f9357707805a4612ebc166766ee2"]="Company Name";
_T["d0845cdf23eb01488ec78802847e0273"]="Enter Company Name";
_T["f111792776dd00af4e9575dffce62c41"]="Phone";
_T["7512ebcca5961d7894b501b6b0556c36"]="Enter Phone Number";
_T["5595a13ebb30e328ffb5b6def210a94c"]="fax";
_T["73fe964a2d78700ea90ec792a87cb425"]="Enter fax Number";
_T["4e3ed651f76a84604309db4a263b8e44"]="Email";
_T["5caf4f1f1ea765a217064568800b9eee"]="Enter Email Address";
_T["7688941a47dfb4d4edaaf460f81d69ab"]="Address";
_T["bcde687f68818bdff785998f3f4b4dcc"]="Enter Address";
_T["7931e6a8fdc03aeb23619c11057cfb46"]="Remarks";
_T["978731b3f7cb08990f958c25b4cc9702"]="Enter remarks";
_T["4c63cd35411e0bfe84d30f523cf6b93a"]="Background Colour";
_T["9c24ec3378fb01fb54d25c2075d3293d"]="Logo Image";
_T["31e77d71bd68053a7d6fcd4bc974af6a"]="No Image Attached";
_T["8ffc3bf05859510e6dc4613b607cdcbe"]="Change / Add Image";
_T["0e671bf5ff1cf6b299f895f78678121b"]="No Image Available";
_T["490679f6791d65bc9998cadb629c7053"]="Add / Change Image";
_T["f5978f4e5815e0516744069dd287e5d9"]="Upload Image";

_T["e7093aef774999cc7b285b9026d61fbc"]="Edit / Create Contact Details";
_T["20cecf51d60a932a53e4effa04ca725e"]="Select Companies";
_T["176d0cbfe29a639fd93aefa5e28bb9d7"]="Searching...";
_T["e3706af55587d8a6780bf1a1532dbed5"]="name";
_T["052a87137b774187a0067115bfb4587b"]="id";
_T["6f088ae28bb1daa7352b86bd635821fe"]="type";
_T["1cb8020d8dad0724355b8da8302e5846"]="int";
_T["f229a7286aed720a11aff9d8ee5dfcba"]="code";
_T["1f9e92e95b9c7973e1d6bb2386dc3f02"]="string";
_T["6ec1b797cb966264539010d6ee338454"]="Error";
_T["d0553b7aba33008f44b8eb2079b9a818"]="Select An Company First";
_T["4b5a536fb1f12c2c1bacc470704d3a40"]="Select Office";
_T["ff30d444b291a8e197e2a11a5e52b00a"]="Cancel";
_T["3925a844dce6f3e0f41c6d8ec011609a"]="Saving";
_T["860acb4d4cfe5cee2d772f0ad317174a"]="submit";
_T["67f3b97a4a67dea87c1981f05c38c6ec"]="Save";

_T["ca999c079c961b36594bef8ea78d08c1"]="Edit / Create Projects";
_T["e83a2e33f1acdf2e2a64bde1b3bfcec4"]="Enter Project Name";
_T["1992ede9b399b98c41e4321e064820b2"]="Select Project Type";
_T["1f8ac8e39a8eaffdd58507aa02062ceb"]="Searching...";
_T["bc25a0e791007b169b709ea7d891c589"]="Project (Unconfirmed)";
_T["9856e19f250af591d4fb74b695c9d930"]="Project";
_T["29f497171d23c51baa092c7f902cc993"]="Project (Closed)";
_T["113eec968aecdfdd5d4576f775b1985b"]="Non-Project";
_T["5c7e7252da639df2fa15316b8c8e4e76"]="Non-Project (Closed)";
_T["c14a3cb937a77ea8a809d70ae08f4270"]="Select Company";
_T["5819b4071b33effaabaf0991a4ce59f8"]="Select Companies";
_T["9f5dc426621d739240f03d3fee8b4c9b"]="name";
_T["d5e18302e65240c3738ef412794bdd0d"]="id";
_T["58408cb47e5d8bca4a44bebac2e80476"]="type";
_T["eee68018087baa8c07fed8b04806382f"]="int";
_T["3cf7df72b8a60c0bfd8292e5355cc22c"]="code";
_T["e9200d9ec9fa5885402850d3fb197354"]="string";
_T["e62e49ac20cf0d683b0bf1f0a43f5b27"]="Select Team";
_T["54a510555d6a6e905b3ae8fb0bafbe25"]="Opened";
_T["d8cd9c04fd6fe262d11c0d7a811a368e"]="Select Person";
_T["965415129e940d4430fdf1effe17c71c"]="Cancel";
_T["1224bdecb4f065210f4b45fd6fbddf53"]="Saving";
_T["72b4d7c8c2fd50e4cc379f5ae50f99f5"]="submit";
_T["97031624e10a4686da8972455bd8be18"]="Save";

_T["9566c872f5eb3606aff77e92ef404f6f"]="Edit Document Type";
_T["918b8aa8008529245b10c94d04e201c6"]="Cancel";
_T["7b0411b72ad383c3e2260d2293b0e2f7"]="Save";
_T["3856b4848e0006d06445a3ec0026e6b9"]="Code";
_T["ba960e685bbb3f9c913365a52e998454"]="Enter code";
_T["04c4d9039b04ae1bb4143edcd3310cc3"]="Document Type";
_T["16fdbf7788088cd5e4251adddf31957e"]="Enter Document Type";
_T["ff98eddf5a2bfb7ab13af0efe685783b"]="Remarks";
_T["cfa368a58af37baf0ff74f80a9d7f192"]="Enter remarks";

_T["4cf1e016d909d25d605d863bc890794c"]="Upload an Image or File";
_T["3b504c4d3b791c1aa278926f21482646"]="Uploading";
_T["f63d2ff3c0824d9a6d914b023170a0e7"]="Error";
_T["de7fa9da20484d1ee51e3e11385b106a"]="Saving failed = fix errors and try again";
_T["6bb7047abac30e5f215a55ee1258d63e"]="Error loading details";
_T["b7aafc07ab3011fde62c5e2f33ac9cc7"]="32M";
_T["584228d91d54c791da0c7b9f60eb0568"]="Cancel";
_T["7e627bc5cadbc3aa73653b2e65eebf41"]="Sending";
_T["34614a479c11ff807e399aa24e7fc850"]="Upload";

_T["7836ab6fe8fe6f6ec502b3108a13e21d"]="Edit Office / Department / Sub Company";
_T["1832ff6f8f4dc04e11d8da18197bd04e"]="Cancel";
_T["09216d718e93d47e7fab400386e0e666"]="Save";
_T["b41c4b23e06e87f60c5cb0bd5bf4de81"]="Company";
_T["526fafd56ab833df1f4ffd447600a9d1"]="Office / Department / Sub Comp. Name";
_T["69424c2ba40b27522c5f582fbe4b754b"]="Enter name";
_T["1576472bc936da286e17816117c69800"]="Address";
_T["c8805cab313fc29f3642f9a5c7f9aa64"]="Enter address";
_T["e726c3820bd60bc1c312fb8c51dc3642"]="Phone";
_T["085c2f603ebade12c9f292ef40fd6b07"]="Enter phone";
_T["85a92c56516f8b4fb28cef275e39aa59"]="fax";
_T["4e53f9de03e95a51293bbd4c2518cc7d"]="Enter fax";
_T["55d8a63eb4ad34aaf8a64e677a7ba02e"]="Email";
_T["20c803184f4250311d36b34678a81e99"]="Enter email";

_T["bc619e5bc0e08070f5aea669b1afdba1"]="Edit Contact Details";

_T["c5f95205dd78ae006d052009aa6142f8"]="Send Introduction Mail";
_T["687a326482448749613f378d040f6ef6"]="Cancel";
_T["7033b8924378a2098ecf784128d96125"]="Save";
_T["98ca94191386d0d2cd58bd272d1df5d7"]="Sending Welcome Message";
_T["92e1985e19c2bb5d9556ac7ba52d5a7a"]="Company";
_T["276038b1ea02816633ab56c087ab5e8b"]="Select Company";
_T["4b59409465457ad433c029640bf1a2c5"]="Searching...";
_T["be407624d99fa1d3edd7ff59c079dd62"]="Office";
_T["b41f06c5d4aa97be01660b5033f3c0b9"]="Office / Department";
_T["99667c31cbee3c1649a9abfba6f76f5f"]="Select Office";
_T["7825faf6d798725b4f9c36122dc0d78f"]="Error";
_T["e81e0305bf7b9c0bff38b1bd4113a94b"]="Select An Company First";
_T["43a33d905d2c47dcd5afccb8d6c5c9ec"]="Contact Name";
_T["801f9098abec829acfaad24d9c38acf1"]="Enter name";
_T["976cb754f8a3120a0d8ddecc7dad70b3"]="Role / Position";
_T["36e08fc5b447ea57d5f9801a0a594de8"]="Enter Role / Position";
_T["8ecda72b47a4d87945396f1deb3a4e2b"]="Phone";
_T["60c2576c3bd6fce9593dfafa60d5dc71"]="Enter phone Number";
_T["6eab94585302a1eb047d8ad46a822fe1"]="Fax";
_T["bbc9b7422ae486331486a0734c399109"]="Enter fax";
_T["fef6c4502e830f3cb17ceda089079d08"]="Email";
_T["b9b189c9b68fd2072e2937f60042e970"]="Enter email";
_T["598d3e15de6c0edc42bbb12bba56848c"]="Email address (one per line)";
_T["56270c6137713c24a973c4239ef10a8c"]="Enter email addresse";
_T["024116eeefc851698f4381072c88c988"]="New Password ";
_T["9ea81314e83737179ff499c00215e349"]="Password (type again to confirm)";
_T["28d4e53cb89a8406eaacfece36ecfbea"]="Always File Messages from this Person in Project";
_T["b5506f1d5c8fcd78b22b830ce30a377f"]="Project";
_T["fac109c69eeb67ebda3c5e40393bcb9b"]="Action Type";
_T["82c0f8b8dd0cb58b397ee9d6f633749e"]="Action Required";
_T["035ee8612761bb1546093a1b22451b67"]="Yes";
_T["4545094571d2bd9ce3dfc20783cf3dbc"]="No";
_T["4e8097f84abcc6d92ca69656d0e94024"]="Select a Company";
_T["3a2644a946cf95a21e5890507232305f"]="You must create a password to send introduction mail";
_T["c9f36f7b1c27b424e71ce6c66a2f000e"]="You must create a password for the admin account";
_T["f202ec7143eb64a7694663d5d795972b"]="Passwords do not match";
_T["b57f7c3a947d7a7a24dcce08a1f789ec"]="Sending";
_T["ecb6cc539899477d30b822eab4f51b57"]="Loading";
_T["6c755092c6556392d8f8589ea57ed32e"]="Select the Company Name";
_T["f81f0fdf4c6384f98a5d1f49ffd0ebe3"]="Send Welcome";
_T["0734055957ed2deb78318855e001f072"]="Send Welcome Messages and Generate Passwords?";
_T["2b80fb0dc406c89322d30ed0c0f6150b"]="\\n";
_T["453b606630064afeccae473d15cb21f1"]="No addresses found";
_T["ffe42f94e27e5228d3d2320e16dfb61b"]="Creating Account / Sending Welcome";
_T["d4efe6bd99e2f9dca237692425cd1e37"]="Please wait...";
_T["78800f89af27b724063900f2ac603ea8"]="Done";
_T["4f53be722b07293542247cc405232a69"]="Done - ";
_T["b3d5fbd734ec40cdb88c7e544b737e57"]=" : ";

_T["3e8788f13c62d5400e2eef9ce61ff6d6"]="Edit Contact Details";

_T["aacd89f134545118f60a671de60913d3"]="New Contact Details";

_T["386f61f04d35fedb1ab564f275a0cc37"]="Add / Edit Staff";

_T["10a9dba27470f2a40030360682301543"]="creating form?";
_T["b1c2642be20746cc54cc9583cb2fb5f5"]="Download Error";

_T["268489fbf761b96488a26a4fc4276b71"]="load";
_T["afb78c23007d0db0645fee10583b13d0"]="Error";
_T["da9c5befbb7a3eea32eb4f9e6b7367a8"]="Failed to Load Template for Spreadsheet";
_T["da2f91721c98c8f3142515049c90f3ae"]="\\n";
_T["159f0d5f1117b89620627cb061376a00"]="No cell to copy for ";
_T["a7726bc866768819d244c2d059209f39"]="Error table not found!?";
_T["f5594d30747272208cff588771f7971c"]="1";
_T["f54fffae1851f4b25ffc7ac7f7060c7a"]="2";
_T["221457ef1ae32f57a44a3e2320f553af"]="0";
_T["05eba7050fdd8cd542e88df78cfa3f58"]="0:0:0";
_T["587dfadc058e0769fbb1fff96b013693"]="FFFF:FFFF:FFFF";
_T["b1a613165b213e18ef40ec56b321f0ed"]="General";
_T["70bcd2b770a103cf8719d7d7177064ef"]="10";
_T["038b0c5aca85f6437b7b6245dcdc092c"]="Missing_download_filename";
_T["04b9481d5d39439cf1fdd4811de667e7"]="Alert";
_T["2e23e2a2b2415903b4c9ab2368caadb5"]="File should have downloaded now";

_T["c1d17a6224927a2a9fedfe19d7a211c3"]="Country";
_T["a11dac8be1a6f587eedf4a1c1e2699ae"]="Select Country";
_T["9bc63702145bdb09708fa539aeefd725"]="Language";
_T["abbb23b334572407b19d843b3dfa3ee5"]="Select Language";
_T["1715e2ee8fbb45f3bb264d9806719b71"]="Currency";
_T["09e12895bf6d4b9974098883faa51a0b"]="Select Currency";
_T["9cdc0fbfc6a23315187fe5cea6cd9c59"]="Language(s)";
_T["3b073f6f35aed6785dbccdf6ea9ecd13"]="Select a language to add.";
_T["0202dbdb1d198fc99ff5e6a12dc1d1ff"]="Searching...";
_T["4e58ecc198012e7ff1b9c77d4617498f"]="Country(s)";
_T["b9cd67022614720c2f168ce18ab32b1c"]="Select a country to add.";

_T["cf72aae865f3f0be736987f7dc390e25"]="Error";
_T["c4eac334a309182656c84b3c69d6337b"]="You are Logged in as <b>{0} ({1})</b>";
_T["0902cdfae7b5ebaa525d4dd4fc121adb"]="Change Password";
_T["ae2d276741dbe18ea7d82cf45e690b71"]="Add New Item";
_T["5359af676f739607431a729778549fdd"]="Logout";
_T["695b0048e081cdd0c1905fde237462bc"]="Closing this window will loose changes, are you sure you want to do that?";
_T["b5f19c6de6e6bde8526a37c2a842e149"]="Loading Document details";
_T["852039f0b664305547a9ce2768a131a4"]="invalid in_out";
_T["9541c362ba7c5444620fc19601a3372d"]="Select at least one Row to delete";
_T["cd4b091c7fe3281497a3b47dfb18e9d9"]="Confirm";
_T["d062a6fe1b74c46d5384e0e4595db834"]="Are you sure you want to delete that?";
_T["02e3cddd44d16389541b6aeb8c790ecc"]="Deleting";
_T["e84cbf769d01c3cf5f2470839353035a"]="Error Deleting";
_T["3fdc18a65a1b517a5009529425c3565b"]="Please Correct all the errors in red";
_T["6ba73887c9a59d4caa85658209534ee8"]="Problem Connecting to Server - please try again.";
_T["7aabc9f3cf1f6785a4bc4dd0f1a2a321"]="Saving failed = fix errors and try again";
_T["b636c0e59d884e880fb4ca5fda048cf4"]="Error loading details";
_T["7b085783b608ea949c9fb9de84016b78"]="Error Sending";
_T["fdf760f049c0a779ad7e88cca6dc642d"]="Connection timed out sending";
_T["4177e7e2dbe28af7f72338aaeb603afd"]="Problem Loading Data";
_T["afaa6ac88a5c532720f81ab8d1cf345d"]=" (clean up) ";
_T["1c34c8962b28be597267aef253b4694b"]="Please wait...";
_T["6a4a6d2119244f74b8d02f20ef005c5e"]="Building Interface...";
_T["51ff98c417d79325f91861af9c61cfb3"]="Building Interface ";
_T["da27970c3ea08e35a23fb956908b78f4"]=" of ";

_T["9f291a7145874911230d9e65522c7d88"]="Error";
_T["bbdf5c921245f319be4e75705be19497"]="Lock Request failed, please try again";
_T["0a911873cb7a0fd7f0746c3a1a22dd7c"]="This Record is Locked by the following people, <br/>";
_T["fb9b9c03fe53aa14b7fb9e14d4cb867f"]="Do you want to continue, this will prevent these people from saving their changes<br/>";
_T["eb35517abbc6b827c277baeace910d36"]="Confirm breaking locks";
_T["00f9887fd3da4059f843fc8a5f758871"]="UnLock Request failed, you may get a warning when trying to edit again";

_T["8391d964e04c0c30d9f19bf036136c8d"]="Error";
_T["4b0bb0bd607983ab0061a86db7fc7ba2"]="Error getting authentication status. - try reloading, or wait a while";
_T["54242987801741c4105cfa0435d9912e"]="Error getting authentication status. - try reloading";
_T["9eba57f4ad82997225a340c5c140a869"]="Warning";
_T["5d5717e963d28007da9511d1416cbc43"]="This is an open system - please set up a admin user with a password.";
_T["68156a5e398303b805bd96fbc6b1f8ee"]="Login";
_T["b2d0ea65f8ae06179a40d78e52b7833c"]="Forgot Password";
_T["9055d707d0388278ceb4f35426316c1b"]="Fill in your email address";
_T["2409934e0552cdd76753d2c11005b6b5"]="Problem Requesting Password Reset";
_T["463c573d3aed3795e9e3145f10cd1416"]="Notice";
_T["de7b06c26e8b5361eb8e33d068dd2ce4"]="Please check you email for the Password Reset message";
_T["31cfba7708e9535c79660355d0f8accf"]="Logging in";
_T["c1b8242e54c06ad890a6a091195f7b8e"]="Login failed - communication error - try again.";
_T["7e698d4c146d9eefd5dcd10552b18098"]="Email Address";
_T["23e3b3bf16c1b9ee0b448a20cde1d8a0"]="input";
_T["356c052df252f5f41bf445742c4a9e92"]="text";
_T["e5c7255d15759b64bbee6c623c299744"]="20";
_T["3b9a78188b115fa00e2285cd1047a02e"]="Password";
_T["b2a3486b5105e365dae1a1796390ba42"]="Language";
_T["b9f8e134e8143020e2eb596292c7c1d1"]="Error logging out. - continuing anyway.";
_T["20f52c7354a3fd19843e600c53121d94"]="Sorry";
_T["1ba0950dff36aebd0c55f3b195edcb11"]="Language not available yet (";

_T["eadd75daa6471a87eb75121dd5eab06a"]="Change Password";
_T["9b6839c225da5cb93c3bf29720e0531d"]="Cancel";
_T["f7c61a97b669d7f5128b51c8644c400c"]="Save";
_T["db88368227b739ed12b165005f43d2c9"]="Error";
_T["23b47796783d663d3113bde8469f9202"]="Please Correct all the errors";
_T["25092a9a028d282401e526d9252c734d"]="Saving failed = fix errors and try again";
_T["39b3f1da7208ad35ea991d47bb460b30"]="Error loading details";
_T["1b6ed9a99ae0f49a874fab476d0e70c4"]="New Password ";
_T["6f52a45578b8376c688a75ddc7888122"]="New Password (type again to confirm)";
_T["78a7430d961bec5b3d4759206ebc2b04"]="Enter Passwords in both boxes";
_T["a217bd43e7427e981bc8dbf18998faed"]="Passwords do not match";

_T["e4fe205ae80b87b90434e12e5e3a4c9b"]="Click to view PDF";

_T["e514ef4c66a523c2440a2225a81f1e79"]="requestcomplete";
_T["c2868ee15182a3ad88334a8025b58188"]="Error";
_T["b7c7cfdbed677c3822a46abcf1f9138a"]="Error Sending data";
_T["7e46ce4689f1051b8c101488de4bced6"]="requestexception";

_T["e82288f1b4eba83e3912993b59e9874c"]="Project";
_T["8e24b2c00ecb83fdbedee6634dbe7a6e"]="Select Project";
_T["dacaeb74293d8e9bb58c28681b02c321"]="Searching...";
_T["993475eb7faf2229459aa6ca1c3745e9"]="Sent To";
_T["f7e6a2016c5b5f0113b18708d84db782"]="Enter Sent To";
_T["adaa177b337c92793900a09979b7644f"]="Type";
_T["f3ae3d381d60864b13244e2ac16c12fe"]="Select Document Type";
_T["f6551e5409cd0bd1293c73466c0d5a71"]="To";
_T["397925800f038e68f28adacc0c39d6ca"]="Select an address to add.";
_T["964610e35dbc2d5e2ef34f1492eff1c7"]="Office / Department";
_T["2b617d7e2e8fdfe8fee08f5086f6e7b7"]="Select Office";

_T["45e376f384cdb1f67a866700b892b3e8"]="Name";
_T["d5cd30d9a8889de9ad91d34e09da494b"]="Not in a Group";
_T["8b2b7b9a1be82d2550e1d2bf71504f40"]="All Staff (Default Permissions)";
_T["0534e1944a96427d47b562c494d85447"]="Everybody";
_T["0b0e4ee0b6875cbaa307a8d7f3c3d7ee"]="All Staff";
_T["b9b270f938cabca10640a932c830a4ce"]="Adminstrators";
_T["982d7a1e24433e552a3d694a095f053e"]="Manage Groups";
_T["0f65f59038860dbf03201afab99fe7e1"]="Add";
_T["0537a153a0e54447d83d2c8d094a03d1"]="Edit";
_T["081fcfe0460716e500eeab497d45d6b8"]="Error";
_T["f845801a4be23199251c41e1c2ac5e98"]="Select only one Row";
_T["178044591ed0652d2b82b7f7eb90b22a"]="Select a Row";
_T["075c26b58d3827f7726bb1eb7c2d13dc"]="You can not rename that group";
_T["1eeb327bd294d207da46d9cfb93f9042"]="Delete";
_T["2d481b48a578e9122e0cda91604a73b1"]="You can not delete that group";
_T["726e57af6b8966adfdcaa385105de4d1"]="Reload";

_T["bf5c8b4410513986dffc6d6d6f025c5f"]="Error";
_T["47d8cbe0203a795d8795f527c887fd48"]="saving failed";
_T["25310235b726d71d9d0bc2fc903b9a3b"]="Staff";
_T["4788be05034a6a24e08add98ed12fddf"]="Displaying ";
_T["0a1ea6b8f312884c024a49ea271b6330"]=" {0} - {1} of {2}";
_T["f405b2cca36f62eb81fa563a0b7406ac"]="No ";
_T["7bca1e8820519d2993ebabfa434007c9"]=" found";
_T["469845eeeb8c7f2983a5fc6550af4dc7"]="Drag person to add or remove from group";
_T["d559132c96908612dd66163dbd532812"]="Drag person to add or remove from team";
_T["40c16e64d6bf564aa75d2287d06c9a7b"]="Show old staff";
_T["2bcbf24c822c1428b849349709d432b4"]="Hide old staff";
_T["39c8bb31d465dfc147324be427ace5e9"]="Add";
_T["a89b59994ae0fe49d108d3e22d68a8f3"]="Bulk Add";
_T["d1ff8ffcb0bc971614aef7c0b5a07290"]="Edit";
_T["8d7a86f0b9a3f7f52e7b49206b42f1ff"]="Select only one Row";
_T["f8eeb7a5fd0bed49c85e3664518a5e7c"]="Select a Row";
_T["1984cf10277dee6c3ff92d27c3b05493"]="Delete";
_T["f128b31c31b3754f5792d2eefdca21d0"]="Search";
_T["87472631093f63c722db73519eb9e4b9"]="Reset Search";
_T["4ee93d3a9b0ad4e3d7c9715890b8e874"]="Switch to Selected User";
_T["2df7f27ebdadf94c09399420535503a9"]="Select a Person";
_T["4d49b66bbfd392f5307e93c277054732"]="Project";
_T["aacd489f97738135f87d1c85be64536b"]="Name";
_T["bd87244321a326daa26695ab4b721c7c"]="Company Type";
_T["60c647263578176b102261a5ae1004a6"]="Company / Office";
_T["3bb13cf053c9459ba5f2bad62a2e208b"]="Office / Dept.";
_T["118585dae50b38d2079b28afa5d768d6"]="Role / Position";
_T["0bfc17408bdeecfce4652e09c3b90621"]="Phone";
_T["1ee4e8e2d1859ff63a7b58f29505249f"]="Fax";
_T["42fcc3face9df26268d1c2bf30dcd747"]="Email";
_T["54bf9f5699148960b91086f351cf159e"]="Active";

Ext.form.ComboBoxLister=function(A){Ext.form.ComboBoxLister.superclass.constructor.call(this,A);this.items=new Roo.util.MixedCollection(false);this.on('select',function(cb,B,ix){this.addItem(B.data);this.setValue('');this.el.dom.value='';});}
Ext.extend(Ext.form.ComboBoxLister,Ext.form.ComboBox,{lastData:false,items:false,nameField:'name',tipField:'email',idField:'id',renderer:false,hiddenName:false,hiddenListName:false,hiddenEl:false,boxWidth:200,allowBlank:true,disableClear:true,onRender:function(ct,A){Ext.form.ComboBoxLister.superclass.onRender.call(this,ct,A);this.wrap.addClass('p-cblist-grp');var B=this.wrap.createChild({tag:'div',cls:'p-cblist-cb'},this.el.dom);if(this.hiddenListName){this.hiddenEl=this.wrap.createChild({tag:'input',type:'hidden',name:this.hiddenListName,value:''});}
this.outerWrap=this.wrap;this.wrap=B;this.outerWrap.setWidth(this.boxWidth);this.outerWrap.dom.removeChild(this.el.dom);this.wrap.dom.appendChild(this.el.dom);this.outerWrap.dom.removeChild(this.trigger.dom);this.wrap.dom.appendChild(this.trigger.dom);this.trigger.setStyle('position','relative');this.trigger.setStyle('left','0px');this.trigger.setStyle('top','2px');this.el.setStyle('vertical-align','text-bottom');if(this.adder){this.adder=this.outerWrap.createChild({tag:'img',src:Ext.BLANK_IMAGE_URL,cls:'x-form-adder',style:'margin-left:2px'});var _t=this;this.adder.on('click',function(e){_t.fireEvent('adderclick',this,e);},_t);}},onResize:function(w,h){Roo.form.ComboBox.superclass.onResize.apply(this,arguments);if(typeof w!='number'){return;}var tw=this.trigger.getWidth();tw+=this.addicon?this.addicon.getWidth():0;tw+=this.editicon?this.editicon.getWidth():0;var x=w-tw;this.el.setWidth(this.adjustWidth('input',x));this.trigger.setStyle('left','0px');if(this.list&&this.listWidth===undefined){var lw=Math.max(x+this.trigger.getWidth(),this.minListWidth);this.list.setWidth(lw);this.innerList.setWidth(lw-this.list.getFrameWidth('lr'));}},addItem:function(A){if(this.items.indexOfKey(A[this.idField])>-1){return;}var x=new Ext.form.ComboBoxLister.Item({data:A,nameField:this.nameField,tipField:this.tipField,cb:this});this.items.add(A[this.idField],x);this.updateHiddenEl();x.render(this.outerWrap,this.wrap.dom);},updateHiddenEl:function(){this.validate();if(!this.hiddenEl){return;}var ar=[];var A=this.idField;this.items.each(function(f){ar.push(f.data[A]);});this.hiddenEl.dom.value=ar.join(',');this.validate();},reset:function(){Roo.form.ComboBoxLister.superclass.reset.call(this);this.items.each(function(f){f.remove();});if(this.hiddenEl){this.hiddenEl.dom.value='';}},getValue:function(){return this.hiddenEl?this.hiddenEl.dom.value:'';},setValue:function(v){if(typeof(v)!='object'){return;}var A=this;Roo.each(v,function(l){A.addItem(l);});},validateValue:function(A){return Roo.form.ComboBoxLister.superclass.validateValue.call(this,this.getValue());}});Ext.form.ComboBoxLister.Item=function(A){A.id=Roo.id();Roo.form.ComboBoxLister.Item.superclass.constructor.call(this,A);}
Roo.extend(Roo.form.ComboBoxLister.Item,Roo.BoxComponent,{data:{},cb:false,defaultAutoCreate:{tag:'div',cls:'p-cblist-item',cn:[{tag:'div'},{tag:'img',width:16,height:16,src:Roo.BLANK_IMAGE_URL,align:'center'}]},onRender:function(ct,A){Roo.form.Field.superclass.onRender.call(this,ct,A);if(!this.el){var B=this.getAutoCreate();this.el=ct.createChild(B,A);}
this.el.child('img').dom.setAttribute('src',Roo.BLANK_IMAGE_URL);this.el.child('div').dom.innerHTML=this.cb.renderer?this.cb.renderer(this.data):String.format('{0}',this.data[this.nameField]);this.el.child('div').dom.setAttribute('qtip',String.format('{0}',this.data[this.tipField]));this.el.child('img').on('click',this.remove,this);},remove:function(){this.cb.items.remove(this);this.el.child('img').un('click',this.remove,this);this.el.remove();this.cb.updateHiddenEl();}});
Pman.Readers.Companies={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:['code','name','remarks',{name:'owner_id',type:'int'},'address','tel','fax','email',{name:'id',type:'int'},{name:'isOwner',type:'int'},{name:'logo_id',type:'int'},'background_color','comptype','ava_craft','url',{name:'main_office_id',type:'int'},{name:'created_by',type:'int'},{name:'created_dt',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'updated_by',type:'int'},{name:'updated_dt',type:'date',dateFormat:'Y-m-d H:i:s'},'passwd',{name:'logo_id_id',type:'int'},'logo_id_filename','logo_id_ontable',{name:'logo_id_onid',type:'int'},'logo_id_mimetype',{name:'logo_id_width',type:'int'},{name:'logo_id_height',type:'int'},{name:'logo_id_filesize',type:'int'},{name:'logo_id_displayorder',type:'int'},'logo_id_language',{name:'logo_id_parent_image_id',type:'int'},{name:'logo_id_created',type:'date',dateFormat:'Y-m-d H:i:s'},'logo_id_imgtype','logo_id_linkurl','logo_id_descript','logo_id_title',{name:'owner_id_id',type:'int'},{name:'owner_id_office_id',type:'int'},'owner_id_name','owner_id_phone','owner_id_fax','owner_id_email',{name:'owner_id_company_id',type:'int'},'owner_id_role',{name:'owner_id_active',type:'int'},'owner_id_remarks','owner_id_passwd',{name:'owner_id_owner_id',type:'int'},'owner_id_lang',{name:'owner_id_no_reset_sent',type:'int'},{name:'owner_id_project_id',type:'int'},'owner_id_action_type',{name:'main_office_id_id',type:'int'},{name:'main_office_id_company_id',type:'int'},'main_office_id_name','main_office_id_address','main_office_id_phone','main_office_id_fax','main_office_id_email','main_office_id_role']};Pman.Readers.Events={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},'person_name',{name:'event_when',type:'date',dateFormat:'Y-m-d H:i:s'},'action','ipaddr',{name:'on_id',type:'int'},'on_table',{name:'person_id',type:'int'},'remarks',{name:'person_id_id',type:'int'},{name:'person_id_office_id',type:'int'},'person_id_name','person_id_phone','person_id_fax','person_id_email',{name:'person_id_company_id',type:'int'},'person_id_role',{name:'person_id_active',type:'int'},'person_id_remarks','person_id_passwd',{name:'person_id_owner_id',type:'int'},'person_id_lang',{name:'person_id_no_reset_sent',type:'int'},{name:'person_id_project_id',type:'int'},'person_id_action_type']};Pman.Readers.Group_Members={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'group_id',type:'int'},{name:'id',type:'int'},{name:'user_id',type:'int'},{name:'group_id_id',type:'int'},'group_id_name',{name:'group_id_type',type:'int'},{name:'group_id_leader',type:'int'},{name:'user_id_id',type:'int'},{name:'user_id_office_id',type:'int'},'user_id_name','user_id_phone','user_id_fax','user_id_email',{name:'user_id_company_id',type:'int'},'user_id_role',{name:'user_id_active',type:'int'},'user_id_remarks','user_id_passwd',{name:'user_id_owner_id',type:'int'},'user_id_lang',{name:'user_id_no_reset_sent',type:'int'},{name:'user_id_project_id',type:'int'},'user_id_action_type']};Pman.Readers.Group_Rights={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:['rightname',{name:'group_id',type:'int'},'AccessMask',{name:'id',type:'int'},{name:'group_id_id',type:'int'},'group_id_name',{name:'group_id_type',type:'int'},{name:'group_id_leader',type:'int'}]};Pman.Readers.Groups={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},'name',{name:'type',type:'int'},{name:'leader',type:'int'},{name:'leader_id',type:'int'},{name:'leader_office_id',type:'int'},'leader_name','leader_phone','leader_fax','leader_email',{name:'leader_company_id',type:'int'},'leader_role',{name:'leader_active',type:'int'},'leader_remarks','leader_passwd',{name:'leader_owner_id',type:'int'},'leader_lang',{name:'leader_no_reset_sent',type:'int'},{name:'leader_project_id',type:'int'},'leader_action_type']};Pman.Readers.Images={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},'filename','ontable',{name:'onid',type:'int'},'mimetype',{name:'width',type:'int'},{name:'height',type:'int'},{name:'filesize',type:'int'},{name:'displayorder',type:'int'},'language',{name:'parent_image_id',type:'int'},{name:'created',type:'date',dateFormat:'Y-m-d H:i:s'},'imgtype','linkurl','descript','title',{name:'parent_image_id_id',type:'int'},'parent_image_id_filename','parent_image_id_ontable',{name:'parent_image_id_onid',type:'int'},'parent_image_id_mimetype',{name:'parent_image_id_width',type:'int'},{name:'parent_image_id_height',type:'int'},{name:'parent_image_id_filesize',type:'int'},{name:'parent_image_id_displayorder',type:'int'},'parent_image_id_language',{name:'parent_image_id_parent_image_id',type:'int'},{name:'parent_image_id_created',type:'date',dateFormat:'Y-m-d H:i:s'},'parent_image_id_imgtype','parent_image_id_linkurl','parent_image_id_descript','parent_image_id_title']};Pman.Readers.Office={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},{name:'company_id',type:'int'},'name','address','phone','fax','email','role','company_id_code','company_id_name','company_id_remarks',{name:'company_id_owner_id',type:'int'},'company_id_address','company_id_tel','company_id_fax','company_id_email',{name:'company_id_id',type:'int'},{name:'company_id_isOwner',type:'int'},{name:'company_id_logo_id',type:'int'},'company_id_background_color','company_id_comptype','company_id_ava_craft','company_id_url',{name:'company_id_main_office_id',type:'int'},{name:'company_id_created_by',type:'int'},{name:'company_id_created_dt',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'company_id_updated_by',type:'int'},{name:'company_id_updated_dt',type:'date',dateFormat:'Y-m-d H:i:s'},'company_id_passwd']};Pman.Readers.Person={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},{name:'office_id',type:'int'},'name','phone','fax','email',{name:'company_id',type:'int'},'role',{name:'active',type:'int'},'remarks','passwd',{name:'owner_id',type:'int'},'lang',{name:'no_reset_sent',type:'int'},{name:'project_id',type:'int'},'action_type',{name:'office_id_id',type:'int'},{name:'office_id_company_id',type:'int'},'office_id_name','office_id_address','office_id_phone','office_id_fax','office_id_email','office_id_role','company_id_code','company_id_name','company_id_remarks',{name:'company_id_owner_id',type:'int'},'company_id_address','company_id_tel','company_id_fax','company_id_email',{name:'company_id_id',type:'int'},{name:'company_id_isOwner',type:'int'},{name:'company_id_logo_id',type:'int'},'company_id_background_color','company_id_comptype','company_id_ava_craft','company_id_url',{name:'company_id_main_office_id',type:'int'},{name:'company_id_created_by',type:'int'},{name:'company_id_created_dt',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'company_id_updated_by',type:'int'},{name:'company_id_updated_dt',type:'date',dateFormat:'Y-m-d H:i:s'},'company_id_passwd',{name:'project_id_id',type:'int'},'project_id_name','project_id_remarks',{name:'project_id_owner_id',type:'int'},'project_id_code',{name:'project_id_active',type:'int'},'project_id_type',{name:'project_id_client_id',type:'int'},{name:'project_id_team_id',type:'int'},'project_id_file_location',{name:'project_id_open_date',type:'date',dateFormat:'Y-m-d'},{name:'project_id_open_by',type:'int'},'project_id_countries','project_id_languages',{name:'project_id_close_date',type:'date',dateFormat:'Y-m-d'},{name:'project_id_agency_id',type:'int'},{name:'owner_id_id',type:'int'},{name:'owner_id_office_id',type:'int'},'owner_id_name','owner_id_phone','owner_id_fax','owner_id_email',{name:'owner_id_company_id',type:'int'},'owner_id_role',{name:'owner_id_active',type:'int'},'owner_id_remarks','owner_id_passwd',{name:'owner_id_owner_id',type:'int'},'owner_id_lang',{name:'owner_id_no_reset_sent',type:'int'},{name:'owner_id_project_id',type:'int'},'owner_id_action_type']};Pman.Readers.Projects={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},'name','remarks',{name:'owner_id',type:'int'},'code',{name:'active',type:'int'},'type',{name:'client_id',type:'int'},{name:'team_id',type:'int'},'file_location',{name:'open_date',type:'date',dateFormat:'Y-m-d'},{name:'open_by',type:'int'},'countries','languages',{name:'close_date',type:'date',dateFormat:'Y-m-d'},{name:'agency_id',type:'int'},'client_id_code','client_id_name','client_id_remarks',{name:'client_id_owner_id',type:'int'},'client_id_address','client_id_tel','client_id_fax','client_id_email',{name:'client_id_id',type:'int'},{name:'client_id_isOwner',type:'int'},{name:'client_id_logo_id',type:'int'},'client_id_background_color','client_id_comptype','client_id_ava_craft','client_id_url',{name:'client_id_main_office_id',type:'int'},{name:'client_id_created_by',type:'int'},{name:'client_id_created_dt',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'client_id_updated_by',type:'int'},{name:'client_id_updated_dt',type:'date',dateFormat:'Y-m-d H:i:s'},'client_id_passwd','agency_id_code','agency_id_name','agency_id_remarks',{name:'agency_id_owner_id',type:'int'},'agency_id_address','agency_id_tel','agency_id_fax','agency_id_email',{name:'agency_id_id',type:'int'},{name:'agency_id_isOwner',type:'int'},{name:'agency_id_logo_id',type:'int'},'agency_id_background_color','agency_id_comptype','agency_id_ava_craft','agency_id_url',{name:'agency_id_main_office_id',type:'int'},{name:'agency_id_created_by',type:'int'},{name:'agency_id_created_dt',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'agency_id_updated_by',type:'int'},{name:'agency_id_updated_dt',type:'date',dateFormat:'Y-m-d H:i:s'},'agency_id_passwd',{name:'team_id_id',type:'int'},'team_id_name',{name:'team_id_type',type:'int'},{name:'team_id_leader',type:'int'},{name:'open_by_id',type:'int'},{name:'open_by_office_id',type:'int'},'open_by_name','open_by_phone','open_by_fax','open_by_email',{name:'open_by_company_id',type:'int'},'open_by_role',{name:'open_by_active',type:'int'},'open_by_remarks','open_by_passwd',{name:'open_by_owner_id',type:'int'},'open_by_lang',{name:'open_by_no_reset_sent',type:'int'},{name:'open_by_project_id',type:'int'},'open_by_action_type',{name:'owner_id_id',type:'int'},{name:'owner_id_office_id',type:'int'},'owner_id_name','owner_id_phone','owner_id_fax','owner_id_email',{name:'owner_id_company_id',type:'int'},'owner_id_role',{name:'owner_id_active',type:'int'},'owner_id_remarks','owner_id_passwd',{name:'owner_id_owner_id',type:'int'},'owner_id_lang',{name:'owner_id_no_reset_sent',type:'int'},{name:'owner_id_project_id',type:'int'},'owner_id_action_type']};Pman.Readers.I18n={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},'ltype','lkey','inlang','lval']};Pman.Readers.Proftp_groups={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},{name:'grpid',type:'int'},'grpname','grpmembers']};Pman.Readers.Translations={root:'data',totalProperty:'total',id:'id',xtype:'JsonReader',fields:[{name:'id',type:'int'},'module','tfile','tlang','tkey','tval']};
Pman.Dialog.Companies=new Roo.util.Observable({events:{'beforerender':true,'show':true,'beforesave':true},dialog:false,form:false,callback:false,create:function(){if(this.dialog){return;}
this.dialog=new Ext.LayoutDialog(Ext.get(document.body).createChild({tag:'div'}),{autoCreated:true,title:_T["daed45fe377199115ee46b87eb340dcc"],modal:true,width:750,height:400,shadow:true,minWidth:200,minHeight:180,collapsible:false,closable:false,draggable:false,center:{autoScroll:false,titlebar:false,hideTabs:true,closeOnTab:true,alwaysShowTabs:false}});this.dialog.addKeyListener(27,this.dialog.hide,this.dialog);this.dialog.addButton(_T["e35c34d957d7aebd0c9e37aa77f50b70"],this.dialog.hide,this.dialog);this.dialog.addButton(_T["59c001255d821a2e12e8fb705dba9fea"],this.save,this);this.layout=this.dialog.getLayout();this.layout.beginUpdate();var A=this;this.form=new Ext.form.Form({labelWidth:150,fileUpload:true,listeners:{actionfailed:function(f,B){A.dialog.el.unmask();Pman.standardActionFailed(f,B);},actioncomplete:function(f,B){A.dialog.el.unmask();if(B.type=='load'){A.data=B.result.data;var C=A.data.isOwner||!Pman.Login.isOwner()?'disable':'enable';if(A.form.findField('comptype')){A.form.findField('comptype')[C]();}return;}if(B.type=='submit'){A.dialog.hide();if(A.callback){A.callback.call(this,B.result.data);}return;}}}});this.form.addxtype.apply(this.form,this.getFormFields());this.fireEvent('beforeRender',this);var ef=this.dialog.getLayout().getEl().createChild({tag:'div'});ef.dom.style.margin=10;this.form.render(ef.dom);var vp=this.dialog.getLayout().add('center',new Ext.ContentPanel(ef,{autoCreate:true,width:250,maxWidth:250,fitToFrame:true}));this.layout.endUpdate();},show:function(A,B){this.callback=B;this._id=A.id?A.id:0;this.create();this.data=A;this.form.reset();if(A._fetch){this.dialog.show();this.dialog.el.mask(_T["5f679f3c301a24b3f538a9766ee3ae6e"]);this.form.doAction('load',{url:baseURL+'/Roo/Companies.html',method:'GET',params:{_id:this._id,_ts:Math.random()}});this.fireEvent('show');return;}else {this.form.setValues(A);}
this.dialog.show();if(A.isOwner||!Pman.Login.isOwner()){this.dialog.setTitle(_T["1f0d43f377b93713beb48cbaca0e4401"]);if(this.form.findField('comptype')){this.form.findField('comptype').disable();}}else {this.dialog.setTitle(A.id?_T["4cf24f0f74944b39fd350182d5e15817"]:_T["ce9ba64bb3f29723e000efb2e80abb8e"]);if(this.form.findField('comptype')){this.form.findField('comptype').enable();}}
this.fireEvent('show');},save:function(){this.form.fileUpload=this.form.findField('imageUpload')?true:false;this.fireEvent('beforesave');this.form.doAction('submit',{url:baseURL+'/Roo/Companies.html',method:'POST',params:{_id:this._id,ts:Math.random()}});},comptypeList:function(){return [['CONSULTANT',_T["650deecbb5e829066db9b03be1125a1c"]],['CLIENT',_T["59bfcea58d8c79f4a8cc2ce8256a167a"]],['CONTRACTOR',_T["692e49978c615ffee8b37ed3a8ef2a12"]]];},comptypeListToString:function(v){if(!v.length){return '';}if(v==_T["e3aa17d446c7005272762934b3b1e1a0"]){return _T["3fbd4316b2e824257633036893085545"];}var a=this.comptypeList();var A='';Roo.each(a,function(ar){if(ar[0]==v){A=ar[1];return false;}});return A;},getFormFields:function(){return [{xtype:'Column',width:500,items:[this.c_code(),this.c_comptype_name(),this.c_name(),this.c_tel(),this.c_fax(),this.c_email(),this.c_address(),this.c_remarks()]},{xtype:'Column',width:200,labelAlign:'top',items:[this.c_background_color(),this.c_image_edit()]},this.c_isOwner(),this.c_id()];},c_code:function(){return {name:'code',fieldLabel:_T["857adf078513b5f11f815595aa0f9fd1"],value:'',allowBlank:false,qtip:_T["75d069b37c5159f5acb5d01d10a2d9a3"],xtype:'TextField',width:100}},c_comptype_name:function(){return {fieldLabel:'Type',disabled:Pman.Login.isOwner()?false:true,name:'comptype_name',xtype:'ComboBox',allowBlank:false,qtip:'Select Company type',width:200,xns:Roo.form,listWidth:250,store:{xtype:'SimpleStore',fields:['val','desc'],data:this.comptypeList()},displayField:'desc',valueField:'val',hiddenName:'comptype',typeAhead:false,editable:false,triggerAction:'all',emptyText:_T["81cbd120755795f72b127151e540cde5"],selectOnFocus:true}},c_name:function(){return {name:'name',fieldLabel:_T["37b6f9357707805a4612ebc166766ee2"],value:'',allowBlank:true,qtip:_T["d0845cdf23eb01488ec78802847e0273"],xtype:'TextField',width:300}},c_tel:function(){return {name:'tel',fieldLabel:_T["f111792776dd00af4e9575dffce62c41"],value:'',allowBlank:true,qtip:_T["7512ebcca5961d7894b501b6b0556c36"],xtype:'TextField',width:300}},c_fax:function(){return {name:'fax',fieldLabel:_T["5595a13ebb30e328ffb5b6def210a94c"],value:'',allowBlank:true,qtip:_T["73fe964a2d78700ea90ec792a87cb425"],xtype:'TextField',width:300}},c_email:function(){return {name:'email',fieldLabel:_T["4e3ed651f76a84604309db4a263b8e44"],value:'',allowBlank:true,qtip:_T["5caf4f1f1ea765a217064568800b9eee"],xtype:'TextField',width:300}},c_address:function(){return {name:'address',fieldLabel:_T["7688941a47dfb4d4edaaf460f81d69ab"],value:'',allowBlank:true,qtip:_T["bcde687f68818bdff785998f3f4b4dcc"],xtype:'TextArea',height:70,width:300}},c_remarks:function(){return {name:'remarks',fieldLabel:_T["7931e6a8fdc03aeb23619c11057cfb46"],value:'',allowBlank:true,qtip:_T["978731b3f7cb08990f958c25b4cc9702"],xtype:'TextArea',height:40,width:300}},c_background_color:function(){return {xtype:'ColorField',name:'background_color',fieldLabel:_T["4c63cd35411e0bfe84d30f523cf6b93a"]}},c_image_view:function(){var A=this;return {xtype:'FieldSetEx',name:'image-view',collapseGroup:'companies-image',value:0,labelWidth:100,expanded:true,style:'width:420px;',legend:_T["9c24ec3378fb01fb54d25c2075d3293d"],items:[{xtype:'DisplayImage',name:'logo_id',fieldLabel:'Logo Image',width:300,height:50,renderer:function(v){return v?String.format('<img src="{0}" height="{1}">',baseURL+'/Images/'+v+'/'+A.data.logo_id_filename,Math.min(this.height,A.data.logo_id_height)):_T["31e77d71bd68053a7d6fcd4bc974af6a"];}}]}},c_image_edit:function(){var A=this;return {name:'logo_id',fieldLabel:_T["9c24ec3378fb01fb54d25c2075d3293d"],value:'',allowBlank:true,style:'border: 1px solid #ccc;',xtype:'DisplayImage',width:170,height:170,addTitle:_T["8ffc3bf05859510e6dc4613b607cdcbe"],icon:Roo.rootURL+'images/default/dd/drop-add.gif',handler:function(){var _t=this;Pman.Dialog.Image.show({onid:A.data.id,ontable:'Companies',imgtype:'-LOGO'},function(B){if(B){_t.setValue(B.id);}});},renderer:function(v){if(!v){return _T["0e671bf5ff1cf6b299f895f78678121b"]+'<BR/>';}return String.format('<img src="{0}" width="150">',baseURL+'/Images/Thumb/150x150/'+v+'/logo.jpg');}};},c_image_change:function(){return {xtype:'FieldSetEx',collapseGroup:'companies-image',name:'image-change',value:0,labelWidth:100,expanded:false,style:'width:420px;',legend:_T["490679f6791d65bc9998cadb629c7053"],items:[{xtype:'TextField',name:'imageUpload',fieldLabel:_T["f5978f4e5815e0516744069dd287e5d9"],inputType:'file'}]}},c_isOwner:function(){return {name:'isOwner',value:'',xtype:'Hidden'}},c_id:function(){return {name:'id',value:'',xtype:'Hidden'}}});
Pman.Dialog.CorePersonContact={dialog:false,callback:false,show:function(A,cb){if(!this.dialog){this.create();}
this.callback=cb;this.data=A;this.dialog.show(this.data._el);if(this.form){this.form.reset();this.form.setValues(A);this.form.fireEvent('actioncomplete',this.form,{type:'setdata',data:A});}},create:function(){var A=this;this.dialog=Roo.factory({xtype:'LayoutDialog',xns:Roo,closable:false,collapsible:false,height:290,resizable:false,title:_T["e7093aef774999cc7b285b9026d61fbc"],width:450,items:[{xtype:'ContentPanel',xns:Roo,region:'center',items:[{xtype:'Form',xns:Roo.form,listeners:{actioncomplete:function(B,C){if(C.type=='setdata'){return;}if(C.type=='load'){A.dialog.el.unmask();return;}if(C.type=='submit'){A.dialog.el.unmask();A.dialog.hide();if(A.callback){A.callback.call(A,A.form.getValues());}
A.form.reset();return;}},rendered:function(B){A.form=B;}},method:'POST',style:'margin:10px;',url:baseURL+'/Roo/Person.php',items:[{xtype:'ComboBox',xns:Roo.form,listeners:{add:function(B){Pman.Dialog.Companies.show({id:0},function(C){A.form.setValues({company_id_name:C.name,company_id:C.id});});}},allowBlank:'false',displayField:'code',editable:'false',emptyText:_T["20cecf51d60a932a53e4effa04ca725e"],fieldLabel:'Company',forceSelection:true,hiddenName:'company_id',listWidth:400,loadingText:_T["176d0cbfe29a639fd93aefa5e28bb9d7"],minChars:2,name:'company_id_code',pageSize:20,qtip:_T["20cecf51d60a932a53e4effa04ca725e"],queryParam:'query[code]',selectOnFocus:true,tpl:'<div class="x-grid-cell-text x-btn button"><b>{code}</b> </div>',triggerAction:'all',typeAhead:true,valueField:'id',width:300,store:{xtype:'Store',xns:Roo.data,remoteSort:true,sortInfo:{direction:'ASC',field:'id'},listeners:{beforeload:function(B,o){o.params=o.params||{};}},proxy:{xtype:'HttpProxy',xns:Roo.data,method:'GET',url:baseURL+'/Roo/Companies.php'},reader:{xtype:'JsonReader',xns:Roo.data,id:'id',root:'data',totalProperty:'total',fields:[{_T["e3706af55587d8a6780bf1a1532dbed5"]:_T["052a87137b774187a0067115bfb4587b"],_T["6f088ae28bb1daa7352b86bd635821fe"]:_T["1cb8020d8dad0724355b8da8302e5846"]},{_T["e3706af55587d8a6780bf1a1532dbed5"]:_T["f229a7286aed720a11aff9d8ee5dfcba"],_T["6f088ae28bb1daa7352b86bd635821fe"]:_T["1f9e92e95b9c7973e1d6bb2386dc3f02"]}]}}},{xtype:'ComboBox',xns:Roo.form,listeners:{add:function(B){var C=A.form.findField('company_id').getValue();if(!C){Ext.MessageBox.alert(_T["6ec1b797cb966264539010d6ee338454"],_T["d0553b7aba33008f44b8eb2079b9a818"]);return false;}
Pman.Dialog.Office.show(cfg,function(D){A.form.setValues({office_id_name:D.name,office_id:D.id});});},beforequery:function(B,C,D,E,e){var F=A.form.findField('company_id').getValue();if(F<1){Ext.MessageBox.alert(_T["6ec1b797cb966264539010d6ee338454"],_T["d0553b7aba33008f44b8eb2079b9a818"]);return false;}}},allowBlank:'false',displayField:'name',editable:'false',emptyText:_T["4b5a536fb1f12c2c1bacc470704d3a40"],fieldLabel:'Office',forceSelection:true,hiddenName:'office_id',listWidth:400,loadingText:_T["176d0cbfe29a639fd93aefa5e28bb9d7"],minChars:2,name:'office_id_name',pageSize:20,qtip:_T["4b5a536fb1f12c2c1bacc470704d3a40"],queryParam:'query[name]',selectOnFocus:true,tpl:'<div class="x-grid-cell-text x-btn button"><b>{name}</b> </div>',triggerAction:'all',typeAhead:true,valueField:'id',width:300,store:{xtype:'Store',xns:Roo.data,listeners:{beforeload:function(B,o){o.params=o.params||{};var C=A.form.findField('company_id').getValue();o.params.company_id=C;}},remoteSort:true,sortInfo:{direction:'ASC',field:'id'},proxy:{xtype:'HttpProxy',xns:Roo.data,method:'GET',url:baseURL+'/Roo/Office.php'},reader:{xtype:'JsonReader',xns:Roo.data,id:'id',root:'data',totalProperty:'total',fields:[{_T["e3706af55587d8a6780bf1a1532dbed5"]:_T["052a87137b774187a0067115bfb4587b"],_T["6f088ae28bb1daa7352b86bd635821fe"]:_T["1cb8020d8dad0724355b8da8302e5846"]},{_T["e3706af55587d8a6780bf1a1532dbed5"]:_T["e3706af55587d8a6780bf1a1532dbed5"],_T["6f088ae28bb1daa7352b86bd635821fe"]:_T["1f9e92e95b9c7973e1d6bb2386dc3f02"]}]}}},{xtype:'TextField',xns:Roo.form,fieldLabel:'Name',name:'name',width:300,allowBlank:true},{xtype:'TextField',xns:Roo.form,fieldLabel:'Role',name:'role',width:200},{xtype:'TextField',xns:Roo.form,fieldLabel:'Phone',name:'phone',width:200},{xtype:'TextField',xns:Roo.form,fieldLabel:'Fax',name:'fax',width:200},{xtype:'TextField',xns:Roo.form,allowBlank:false,fieldLabel:'Email',name:'email',width:200},{xtype:'Hidden',xns:Roo.form,name:'id'}]}]}],center:{xtype:'LayoutRegion',xns:Roo},buttons:[{xtype:'Button',xns:Roo,listeners:{click:function(B,e){A.dialog.hide();}},text:_T["ff30d444b291a8e197e2a11a5e52b00a"]},{xtype:'Button',xns:Roo,listeners:{click:function(B,e){A.dialog.el.mask(_T["3925a844dce6f3e0f41c6d8ec011609a"]);A.form.doAction(_T["860acb4d4cfe5cee2d772f0ad317174a"]);}},text:_T["67f3b97a4a67dea87c1981f05c38c6ec"]}]});}};
Pman.Dialog.CoreProject={dialog:false,callback:false,show:function(A,cb){if(!this.dialog){this.create();}
this.callback=cb;this.data=A;this.dialog.show(this.data._el);if(this.form){this.form.reset();this.form.setValues(A);this.form.fireEvent('actioncomplete',this.form,{type:'setdata',data:A});}},create:function(){var A=this;this.dialog=Roo.factory({xtype:'LayoutDialog',xns:Roo,closable:false,collapsible:false,height:450,resizable:false,title:_T["ca999c079c961b36594bef8ea78d08c1"],width:470,items:[{xtype:'ContentPanel',xns:Roo,region:'center',items:[{xtype:'Form',xns:Roo.form,listeners:{actioncomplete:function(B,C){if(C.type=='setdata'){return;}if(C.type=='load'){A.dialog.el.unmask();return;}if(C.type=='submit'){A.dialog.el.unmask();A.dialog.hide();if(A.callback){A.callback.call(A,A.form.getValues());}
A.form.reset();return;}},rendered:function(B){A.form=B;}},method:'POST',style:'margin:10px;',url:baseURL+'/Roo/Projects.php',items:[{xtype:'TextField',xns:Roo.form,fieldLabel:'Code',name:'code',width:150},{xtype:'TextField',xns:Roo.form,fieldLabel:'Project Name',name:'name',qtip:_T["e83a2e33f1acdf2e2a64bde1b3bfcec4"],width:300},{xtype:'ComboBox',xns:Roo.form,allowBlank:false,displayField:'desc',editable:false,emptyText:_T["1992ede9b399b98c41e4321e064820b2"],fieldLabel:'Project Type',forceSelection:true,hiddenName:'type',listWidth:400,loadingText:_T["1f8ac8e39a8eaffdd58507aa02062ceb"],minChars:2,name:'type_desc',pageSize:20,qtip:_T["1992ede9b399b98c41e4321e064820b2"],queryParam:'query[name]',selectOnFocus:true,tpl:'<div class="x-grid-cell-text x-btn button"><b>{desc}</b> </div>',triggerAction:'all',typeAhead:true,valueField:'code',width:200,store:{xtype:'SimpleStore',xns:Roo.data,data:[['U',_T["bc25a0e791007b169b709ea7d891c589"]],['P',_T["9856e19f250af591d4fb74b695c9d930"]],['C',_T["29f497171d23c51baa092c7f902cc993"]],['N',_T["113eec968aecdfdd5d4576f775b1985b"]],['X',_T["5c7e7252da639df2fa15316b8c8e4e76"]]],fields:['code','desc']}},{xtype:'ComboBox',xns:Roo.form,listeners:{add:function(B){Pman.Dialog.Companies.show({id:0},function(C){A.form.setValues({client_id:C.id,client_id_name:C.name});});}},allowBlank:'false',displayField:'name',editable:'false',emptyText:_T["c14a3cb937a77ea8a809d70ae08f4270"],fieldLabel:'Client',forceSelection:true,hiddenName:'client_id',listWidth:400,loadingText:_T["1f8ac8e39a8eaffdd58507aa02062ceb"],minChars:2,name:'client_id_name',pageSize:20,qtip:_T["5819b4071b33effaabaf0991a4ce59f8"],queryParam:'query[name]',selectOnFocus:true,tpl:'<div class="x-grid-cell-text x-btn button"><b>{name}</b> </div>',triggerAction:'all',typeAhead:true,valueField:'id',width:300,store:{xtype:'Store',xns:Roo.data,listeners:{beforeload:function(B,o){o.params=o.params||{};o.params.type=1;o.params['query[group_pulldown]']=1;}},remoteSort:true,sortInfo:{direction:'ASC',field:'name'},proxy:{xtype:'HttpProxy',xns:Roo.data,method:'GET',url:baseURL+'/Roo/Companies.php'},reader:{xtype:'JsonReader',xns:Roo.data,id:'id',root:'data',totalProperty:'total',fields:[{_T["9f5dc426621d739240f03d3fee8b4c9b"]:_T["d5e18302e65240c3738ef412794bdd0d"],_T["58408cb47e5d8bca4a44bebac2e80476"]:_T["eee68018087baa8c07fed8b04806382f"]},{_T["9f5dc426621d739240f03d3fee8b4c9b"]:_T["3cf7df72b8a60c0bfd8292e5355cc22c"],_T["58408cb47e5d8bca4a44bebac2e80476"]:_T["e9200d9ec9fa5885402850d3fb197354"]}]}}},{xtype:'ComboBox',xns:Roo.form,allowBlank:'false',displayField:'name',editable:'false',emptyText:_T["e62e49ac20cf0d683b0bf1f0a43f5b27"],fieldLabel:'Team',forceSelection:true,hiddenName:'team_id',listWidth:400,loadingText:_T["1f8ac8e39a8eaffdd58507aa02062ceb"],minChars:2,name:'team_id_name',pageSize:20,qtip:_T["e62e49ac20cf0d683b0bf1f0a43f5b27"],queryParam:'query[name]',selectOnFocus:true,tpl:'<div class="x-grid-cell-text x-btn button"><b>{name}</b> </div>',triggerAction:'all',typeAhead:true,valueField:'id',width:300,store:{xtype:'Store',xns:Roo.data,remoteSort:true,sortInfo:{direction:'ASC',field:'id'},listeners:{beforeload:function(B,o){o.params=o.params||{};}},proxy:{xtype:'HttpProxy',xns:Roo.data,method:'GET',url:baseURL+'/Roo/Groups.php'},reader:{xtype:'JsonReader',xns:Roo.data,id:'id',root:'data',totalProperty:'total',fields:[{_T["9f5dc426621d739240f03d3fee8b4c9b"]:_T["d5e18302e65240c3738ef412794bdd0d"],_T["58408cb47e5d8bca4a44bebac2e80476"]:_T["eee68018087baa8c07fed8b04806382f"]},{_T["9f5dc426621d739240f03d3fee8b4c9b"]:_T["9f5dc426621d739240f03d3fee8b4c9b"],_T["58408cb47e5d8bca4a44bebac2e80476"]:_T["e9200d9ec9fa5885402850d3fb197354"]}]}}},{xtype:'TextField',xns:Roo.form,fieldLabel:'File location',name:'file_location',width:300},{xtype:'TextArea',xns:Roo.form,fieldLabel:'Remarks',height:100,name:'remarks',width:300},{xtype:'FieldSet',xns:Roo.form,legend:_T["54a510555d6a6e905b3ae8fb0bafbe25"],items:[{xtype:'DateField',xns:Roo.form,altFormats:'Y-m-d|d/m/Y',fieldLabel:'Open date',format:'d/m/Y',name:'open_date',width:100},{xtype:'ComboBox',xns:Roo.form,allowBlank:'false',editable:'false',emptyText:_T["d8cd9c04fd6fe262d11c0d7a811a368e"],forceSelection:true,listWidth:400,loadingText:_T["1f8ac8e39a8eaffdd58507aa02062ceb"],minChars:2,pageSize:20,qtip:_T["d8cd9c04fd6fe262d11c0d7a811a368e"],selectOnFocus:true,triggerAction:'all',typeAhead:true,width:300,tpl:'<div class="x-grid-cell-text x-btn button"><b>{name}</b> </div>',queryParam:'query[name]',fieldLabel:'Open by',valueField:'id',displayField:'name',hiddenName:'open_by',name:'open_by_name',store:{xtype:'Store',xns:Roo.data,remoteSort:true,sortInfo:{direction:'ASC',field:'id'},listeners:{beforeload:function(B,o){o.params=o.params||{};}},proxy:{xtype:'HttpProxy',xns:Roo.data,method:'GET',url:baseURL+'/Roo/Person.php'},reader:{xtype:'JsonReader',xns:Roo.data,id:'id',root:'data',totalProperty:'total',fields:[{_T["9f5dc426621d739240f03d3fee8b4c9b"]:_T["d5e18302e65240c3738ef412794bdd0d"],_T["58408cb47e5d8bca4a44bebac2e80476"]:_T["eee68018087baa8c07fed8b04806382f"]},{_T["9f5dc426621d739240f03d3fee8b4c9b"]:_T["9f5dc426621d739240f03d3fee8b4c9b"],_T["58408cb47e5d8bca4a44bebac2e80476"]:_T["e9200d9ec9fa5885402850d3fb197354"]}]}}}]},{xtype:'Hidden',xns:Roo.form,name:'id'}]}]}],center:{xtype:'LayoutRegion',xns:Roo},buttons:[{xtype:'Button',xns:Roo,listeners:{click:function(B,e){A.dialog.hide();}},text:_T["965415129e940d4430fdf1effe17c71c"]},{xtype:'Button',xns:Roo,listeners:{click:function(B,e){A.dialog.el.mask(_T["1224bdecb4f065210f4b45fd6fbddf53"]);A.form.doAction(_T["72b4d7c8c2fd50e4cc379f5ae50f99f5"]);}},text:_T["97031624e10a4686da8972455bd8be18"]}]});}};
Pman.Dialog.Document_Types={dialog:false,form:false,create:function(){if(this.dialog){return;}
this.dialog=new Ext.LayoutDialog(Ext.get(document.body).createChild({tag:'div'}),{autoCreated:true,title:_T["9566c872f5eb3606aff77e92ef404f6f"],modal:true,width:650,height:250,shadow:true,minWidth:200,minHeight:180,closable:false,draggable:false,center:{autoScroll:false,titlebar:false,hideTabs:true,closeOnTab:true,alwaysShowTabs:false}});this.dialog.addKeyListener(27,this.dialog.hide,this.dialog);this.dialog.addButton(_T["918b8aa8008529245b10c94d04e201c6"],this.dialog.hide,this.dialog);this.dialog.addButton(_T["7b0411b72ad383c3e2260d2293b0e2f7"],this.save,this);this.layout=this.dialog.getLayout();this.layout.beginUpdate();var dg=Pman.Dialog.Document_Types;this.form=new Ext.form.Form({labelWidth:250,listeners:{actionfailed:function(f,A){dg.dialog.el.unmask();Pman.standardActionFailed(f,A);},actioncomplete:function(f,A){dg.dialog.el.unmask();if(A.type=='load'){dg.data=A.result.data;return;}if(A.type=='submit'){dg.dialog.hide();if(dg.callback){dg.callback.call(this,A.result.data);}return;}}}});this.form.addxtype.apply(this.form,[{name:'code',fieldLabel:_T["3856b4848e0006d06445a3ec0026e6b9"],value:'',allowBlank:false,qtip:_T["ba960e685bbb3f9c913365a52e998454"],xtype:'TextField',width:100},{name:'name',fieldLabel:_T["04c4d9039b04ae1bb4143edcd3310cc3"],value:'',allowBlank:true,qtip:_T["16fdbf7788088cd5e4251adddf31957e"],xtype:'TextField',width:300},{name:'remarks',fieldLabel:_T["ff98eddf5a2bfb7ab13af0efe685783b"],value:'',allowBlank:true,qtip:_T["cfa368a58af37baf0ff74f80a9d7f192"],xtype:'TextArea',height:100,width:300},{name:'id',value:'',xtype:'Hidden'}]);var ef=this.dialog.getLayout().getEl().createChild({tag:'div'});ef.dom.style.margin=10;this.form.render(ef.dom);var vp=this.dialog.getLayout().add('center',new Ext.ContentPanel(ef,{autoCreate:true,width:250,maxWidth:250,fitToFrame:true}));this.layout.endUpdate();},_id:0,show:function(A,B){this.callback=B;this._id=A.id?A.id:0;this.create();this.form.reset();this.form.setValues(A);this.dialog.show();},save:function(){this.form.doAction('submit',{url:baseURL+'/Roo/Document_Types.html',method:'POST',params:{_id:this._id,ts:Math.random()}});}};
Pman.Dialog.Image={dialog:false,callback:false,show:function(A,cb){if(!this.dialog){this.create();}
this.callback=cb;this.data=A;this.dialog.show(this.data._el);if(this.form){this.form.reset();this.form.setValues(A);this.form.fireEvent('actioncomplete',this.form,{type:'setdata',data:A});}},create:function(){var A=this;this.dialog=Roo.factory({xtype:'LayoutDialog',xns:Roo,listeners:{show:function(B){if(this.keylistener){return;}
this.keylistener=this.addKeyListener(27,this.hide,this);}},closable:false,collapsible:false,haveProgress:false,height:140,modal:true,resizable:false,title:_T["4cf1e016d909d25d605d863bc890794c"],uploadComplete:false,width:500,shadow:true,uploadProgress:function(){var B=this;if(!B.haveProgress){Roo.MessageBox.progress(_T["3b504c4d3b791c1aa278926f21482646"],_T["3b504c4d3b791c1aa278926f21482646"]);}if(B.uploadComplete){Roo.MessageBox.hide();return;}
B.haveProgress=true;var C=A.form.findField('UPLOAD_IDENTIFIER').getValue();Pman.request({url:baseURL+'/Core/UploadProgress.php',params:{id:C},method:'GET',success:function(D){if(B.uploadComplete){Roo.MessageBox.hide();return;}if(D){Roo.MessageBox.updateProgress(D.bytes_uploaded/D.bytes_total,Math.floor((D.bytes_total-D.bytes_uploaded)/1000)+'k remaining');}
B.uploadProgress.defer(2000,B);},failure:function(D){}})},items:[{xtype:'ContentPanel',xns:Roo,fitToFrame:true,region:'center',items:[{xtype:'Form',xns:Roo.form,listeners:{actioncomplete:function(B,C){A.dialog.uploadComplete=true;A.dialog.el.unmask();if(C.type=='setdata'){this.url=A.data._url?A.data._url:baseURL+'/Roo/Images.php';this.el.dom.action=this.url;this.findField('UPLOAD_IDENTIFIER').setValue((new Date()*1)+''+Math.random());return;}if(C.type=='load'){A.data=C.result.data;return;}if(C.type=='submit'){A.dialog.hide();if(A.callback){A.callback.call(this,C.result.data);}return;}},rendered:function(B){A.form=B;},actionfailed:function(B,C){A.dialog.uploadComplete=true;A.dialog.el.unmask();if(C.type=='submit'){try{Roo.MessageBox.alert(_T["f63d2ff3c0824d9a6d914b023170a0e7"],C.result.errorMsg);}catch(e){Roo.MessageBox.alert(_T["f63d2ff3c0824d9a6d914b023170a0e7"],_T["de7fa9da20484d1ee51e3e11385b106a"]);}return;}
Roo.MessageBox.alert(_T["f63d2ff3c0824d9a6d914b023170a0e7"],_T["6bb7047abac30e5f215a55ee1258d63e"]);}},fileUpload:true,labelWidth:140,method:'POST',style:'margin:10px;',url:baseURL+'/Roo/Images.php',items:[{xtype:'Hidden',xns:Roo.form,name:'UPLOAD_IDENTIFIER'},{xtype:'Hidden',xns:Roo.form,name:'post_max_size',value:_T["b7aafc07ab3011fde62c5e2f33ac9cc7"]},{xtype:'Hidden',xns:Roo.form,name:'upload_max_filesize',value:_T["b7aafc07ab3011fde62c5e2f33ac9cc7"]},{xtype:'TextField',xns:Roo.form,fieldLabel:'Upload Image or File',inputType:'file',name:'imageUpload',width:200},{xtype:'Hidden',xns:Roo.form,name:'ontable'},{xtype:'Hidden',xns:Roo.form,name:'onid'},{xtype:'Hidden',xns:Roo.form,name:'imgtype'}]}]}],center:{xtype:'LayoutRegion',xns:Roo},buttons:[{xtype:'Button',xns:Roo,listeners:{click:function(B,e){A.dialog.hide();}},text:_T["584228d91d54c791da0c7b9f60eb0568"]},{xtype:'Button',xns:Roo,listeners:{click:function(B,e){A.dialog.el.mask(_T["7e627bc5cadbc3aa73653b2e65eebf41"]);A.dialog.uploadComplete=false;A.form.doAction('submit',{params:{ts:Math.random()}});A.dialog.haveProgress=false,A.dialog.uploadProgress.defer(1000,A.dialog);}},text:_T["34614a479c11ff807e399aa24e7fc850"]}]});}};
Pman.Dialog.Office={dialog:false,form:false,create:function(){if(this.dialog){return;}
this.dialog=new Ext.LayoutDialog(Ext.get(document.body).createChild({tag:'div'}),{autoCreated:true,title:_T["7836ab6fe8fe6f6ec502b3108a13e21d"],modal:true,width:650,height:400,shadow:true,minWidth:200,minHeight:180,closable:false,draggable:false,center:{autoScroll:false,titlebar:false,hideTabs:true,closeOnTab:true,alwaysShowTabs:false}});this.dialog.addKeyListener(27,this.dialog.hide,this.dialog);this.dialog.addButton(_T["1832ff6f8f4dc04e11d8da18197bd04e"],this.dialog.hide,this.dialog);this.dialog.addButton(_T["09216d718e93d47e7fab400386e0e666"],this.save,this);this.layout=this.dialog.getLayout();this.layout.beginUpdate();var dg=Pman.Dialog.Office;this.form=new Ext.form.Form({labelWidth:250,listeners:{actionfailed:function(f,A){dg.dialog.el.unmask();Pman.standardActionFailed(f,A);},actioncomplete:function(f,A){dg.dialog.el.unmask();if(A.type=='load'){dg.data=A.result.data;return;}if(A.type=='submit'){dg.dialog.hide();if(dg.callback){dg.callback.call(this,A.result.data);}return;}}}});this.form.addxtype.apply(this.form,[{'name':'id','value':'','xtype':'Hidden'},{'name':'company_id','value':'','xtype':'Hidden'},{'name':'company_id_name','fieldLabel':_T["b41c4b23e06e87f60c5cb0bd5bf4de81"],'value':'','xtype':'TextField',readOnly:true,'width':300},{'name':'name','fieldLabel':_T["526fafd56ab833df1f4ffd447600a9d1"],'value':'','allowBlank':false,'qtip':_T["69424c2ba40b27522c5f582fbe4b754b"],'xtype':'TextField','width':300},{'name':'address','fieldLabel':_T["1576472bc936da286e17816117c69800"],'value':'','qtip':_T["c8805cab313fc29f3642f9a5c7f9aa64"],'xtype':'TextArea','height':100,'width':300},{'name':'phone','fieldLabel':_T["e726c3820bd60bc1c312fb8c51dc3642"],'value':'','qtip':_T["085c2f603ebade12c9f292ef40fd6b07"],'xtype':'TextField','width':300},{'name':'fax','fieldLabel':_T["85a92c56516f8b4fb28cef275e39aa59"],'value':'','qtip':_T["4e53f9de03e95a51293bbd4c2518cc7d"],'xtype':'TextField','width':300},{'name':'email','fieldLabel':_T["55d8a63eb4ad34aaf8a64e677a7ba02e"],'value':'','qtip':_T["20c803184f4250311d36b34678a81e99"],'xtype':'TextField','width':300}]);var ef=this.dialog.getLayout().getEl().createChild({tag:'div'});ef.dom.style.margin=10;this.form.render(ef.dom);var vp=this.dialog.getLayout().add('center',new Ext.ContentPanel(ef,{autoCreate:true,width:250,maxWidth:250,fitToFrame:true}));this.layout.endUpdate();},_id:0,show:function(A,B){this.callback=B;this._id=A.id;this.create();this.form.reset();this.form.setValues(A);this.dialog.show();this.form.findField('name').focus();},save:function(){this.form.doAction('submit',{url:baseURL+'/Roo/Office.html',method:'POST',params:{_id:this._id,ts:Math.random()}});}};
Pman.on('beforeload',function(){Pman.Dialog.PersonEdit=new Pman.Dialog.PersonEditor({type:'edit',dialogConfig:{title:_T["bc619e5bc0e08070f5aea669b1afdba1"],height:350},itemList:['company_id_name','office_id_name','name','role','phone','fax','email','passwd1','passwd2','id','company_id_email','company_id_address','company_id_tel','company_id_fax']});});
Pman.Dialog.PersonEditor=function(A){Roo.apply(this,A);};Pman.Dialog.PersonEditor.prototype={itemList:false,dialogConfig:false,type:'',itemTypes:false,dialog:false,form:false,layout:false,callback:false,_id:false,data:false,create:function(){if(this.dialog){return;}var A=this;this.dialog=new Ext.LayoutDialog(Ext.get(document.body).createChild({tag:'div'}),Roo.apply({autoCreated:true,title:'Edit Contact Details',modal:true,width:530,height:300,shadow:true,minWidth:200,minHeight:180,closable:false,draggable:false,center:{autoScroll:false,titlebar:false,hideTabs:true,closeOnTab:true,alwaysShowTabs:false}},this.dialogConfig));this.dialog.addKeyListener(27,this.dialog.hide,this.dialog);if(this.itemList.indexOf('save_send')>-1){this.dialog.addButton(_T["c5f95205dd78ae006d052009aa6142f8"],this.saveSend,this);}
this.dialog.addButton(_T["687a326482448749613f378d040f6ef6"],this.dialog.hide,this.dialog);this.dialog.addButton(_T["7033b8924378a2098ecf784128d96125"],this.save,this);this.layout=this.dialog.getLayout();this.layout.beginUpdate();this.form=new Ext.form.Form({labelWidth:120,listeners:{actionfailed:function(f,B){A.dialog.el.unmask();Pman.standardActionFailed(f,B);},actioncomplete:function(f,B){A.dialog.el.unmask();if(B.type=='load'){A.data=B.result.data;}if((B.type=='load')||(B.type=='setdata')){var C=A.data;if(A.form.findField('company_id')&&A.form.findField('company_id').setFromData){A.form.findField('company_id').setFromData(C.company_id?{id:C.company_id,name:C.company_id_name,remarks:C.company_id_remarks,address:C.company_id_address,tel:C.company_id_tel,fax:C.company_id_fax,email:C.company_id_email}:{id:0,name:''});}if(A.form.findField('office_id')&&A.form.findField('office_id').setFromData){A.form.findField('office_id').setFromData(C.office_id?{id:C.office_id,name:C.office_id_name,remarks:C.office_id_remarks,address:C.office_id_address,tel:C.office_id_tel,fax:C.office_id_fax,email:C.office_id_email}:{id:0,name:''});}if(A.form.findField('project_id')){A.form.findbyId('project_id_fs').setExpand(C.project_id?true:false);A.form.findField('project_id').setFromData(C.project_id?{id:C.project_id,code:C.project_id_code}:{id:0,code:''});}if(this.type=='staff'){A.form.findField('passwd1').allowBlank=false;A.form.findField('passwd2').allowBlank=false;if(C.id>0){A.form.findField('passwd1').allowBlank=true;A.form.findField('passwd2').allowBlank=true;}}return;}if(B.type=='submit'){A.dialog.hide();if(A.callback){A.callback.call(this,B.result.data);}if(A.sendAfterSave){B.result.data.rawPasswd=A.form.findField('passwd1').getValue();A.sendIntro([B.result.data],_T["98ca94191386d0d2cd58bd272d1df5d7"]);}return;}}}});this.loadItemTypes();Roo.each(this.itemList,function(il){if(typeof(il)!='object'){A.form.addxtype(A.itemTypes[il]);return true;}
A.form.addxtype(Roo.apply(il,A.itemTypes[il.name]));});var ef=this.dialog.getLayout().getEl().createChild({tag:'div'});ef.dom.style.margin=10;this.form.render(ef.dom);var vp=this.dialog.getLayout().add('center',new Ext.ContentPanel(ef,{autoCreate:true,width:250,maxWidth:250,fitToFrame:true}));this.layout.endUpdate();},loadItemTypes:function(){var A=this;this.itemTypes={company_id_name_ro:{name:'company_id_name',fieldLabel:_T["92e1985e19c2bb5d9556ac7ba52d5a7a"],value:'',xtype:'TextField',readOnly:true,width:300},company_id_name:{xtype:'ComboBoxAdder',fieldLabel:_T["92e1985e19c2bb5d9556ac7ba52d5a7a"],name:'company_id_name',selectOnFocus:true,qtip:_T["276038b1ea02816633ab56c087ab5e8b"],allowBlank:false,width:300,store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Companies.html',method:'GET'},reader:Pman.Readers.Companies,listeners:{beforeload:function(st,o){o.params.isOwner=0;},loadexception:Pman.loadException},sortInfo:{field:'name',direction:'ASC'}},displayField:'name',valueField:'id',hiddenName:'company_id',typeAhead:true,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','<b>{name}</b> {address}','</div>'),queryParam:'query[name]',loadingText:_T["4b59409465457ad433c029640bf1a2c5"],listWidth:400,minChars:2,pageSize:20,listeners:{adderclick:function(){var cb=this;Pman.Dialog.Companies.show({id:0},function(B){cb.setFromData(B);});}}},office_id_name_ro:{name:'office_id_name',fieldLabel:_T["be407624d99fa1d3edd7ff59c079dd62"],value:'',xtype:'TextField',readOnly:true,width:300},office_id_name:{xtype:'ComboBoxAdder',fieldLabel:_T["b41f06c5d4aa97be01660b5033f3c0b9"],name:'office_id_name',selectOnFocus:true,qtip:_T["99667c31cbee3c1649a9abfba6f76f5f"],allowBlank:true,width:300,store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Office.html',method:'GET'},reader:Pman.Readers.Office,listeners:{beforeload:function(st,o){var B=A.form.findField('company_id').getValue();o.params.company_id=B;},loadexception:Pman.loadException},sortInfo:{field:'name',direction:'ASC'}},listeners:{adderclick:function(){var cb=this;var B=false;var C=false;if(A.type=='new'){C=A.form.findField('company_id').lastData;if(!C.id){Ext.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["e81e0305bf7b9c0bff38b1bd4113a94b"]);return false}
B={company_id:C.id,company_id_name:C.name,address:C.address,phone:C.tel,fax:C.fax,email:C.email};}else {C=A.data;B={company_id:C.company_id,company_id_name:C.company_id_name,address:C.company_id_address,phone:C.company_id_tel,fax:C.company_id_fax,email:C.company_id_email}}
Pman.Dialog.Office.show(B,function(D){cb.setFromData(D);});},beforequery:function(qe){var B=A.form.findField('company_id').getValue();if(B<1){Ext.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["e81e0305bf7b9c0bff38b1bd4113a94b"]);return false;}}},displayField:'name',valueField:'id',hiddenName:'office_id',typeAhead:true,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','<b>{name}</b> {address}','</div>'),queryParam:'query[name]',loadingText:_T["4b59409465457ad433c029640bf1a2c5"],listWidth:400,minChars:2,pageSize:20},name:{name:'name',fieldLabel:_T["43a33d905d2c47dcd5afccb8d6c5c9ec"],value:'',allowBlank:false,qtip:_T["801f9098abec829acfaad24d9c38acf1"],xtype:'TextField',width:300},role:{name:'role',fieldLabel:_T["976cb754f8a3120a0d8ddecc7dad70b3"],value:'',allowBlank:true,qtip:_T["36e08fc5b447ea57d5f9801a0a594de8"],xtype:'TextField',width:300},phone:{name:'phone',fieldLabel:_T["8ecda72b47a4d87945396f1deb3a4e2b"],value:'',allowBlank:true,qtip:_T["60c2576c3bd6fce9593dfafa60d5dc71"],xtype:'TextField',width:300},fax:{name:'fax',fieldLabel:_T["6eab94585302a1eb047d8ad46a822fe1"],value:'',allowBlank:true,qtip:_T["bbc9b7422ae486331486a0734c399109"],xtype:'TextField',width:300},email:{name:'email',fieldLabel:_T["fef6c4502e830f3cb17ceda089079d08"],value:'',allowBlank:true,qtip:_T["b9b189c9b68fd2072e2937f60042e970"],xtype:'TextField',width:300},bulklist:{name:'bulklist',fieldLabel:_T["598d3e15de6c0edc42bbb12bba56848c"],value:'',allowBlank:false,qtip:_T["56270c6137713c24a973c4239ef10a8c"],xtype:'TextArea',width:300,height:200},email_req:{name:'email',fieldLabel:_T["fef6c4502e830f3cb17ceda089079d08"],value:'',allowBlank:false,qtip:_T["b9b189c9b68fd2072e2937f60042e970"],xtype:'TextField',width:300},passwd1:{name:'passwd1',fieldLabel:_T["024116eeefc851698f4381072c88c988"],value:'',allowBlank:true,inputType:'password',xtype:'SecurePass',width:220,imageRoot:rootURL+'/Pman/templates/images'},passwd2:{name:'passwd2',fieldLabel:_T["9ea81314e83737179ff499c00215e349"],value:'',allowBlank:true,inputType:'password',xtype:'TextField',width:220},project_id_fs:{xtype:'FieldSetEx',name:'project_id_fs',value:0,labelWidth:100,expanded:false,style:'width:420px;',legend:_T["28d4e53cb89a8406eaacfece36ecfbea"],items:[Pman.Std.project_id({width:300,fieldLabel:_T["b5506f1d5c8fcd78b22b830ce30a377f"],allowBlank:true}),{xtype:'ComboBox',name:'action_type_str',selectOnFocus:true,qtip:_T["fac109c69eeb67ebda3c5e40393bcb9b"],fieldLabel:_T["82c0f8b8dd0cb58b397ee9d6f633749e"],allowBlank:true,width:50,store:new Ext.data.SimpleStore({fields:['code','desc'],data:[['ACTION_REQUIRED',_T["035ee8612761bb1546093a1b22451b67"]],['NOTIFY',_T["4545094571d2bd9ce3dfc20783cf3dbc"]]]}),displayField:'desc',editable:false,valueField:'code',hiddenName:'action_type',value:'ACTION_REQUIRED',forceSelection:true,mode:'local',triggerAction:'all'}]},id:{name:'id',value:'',xtype:'Hidden'},save_send:{name:'_save_send',value:0,xtype:'Hidden'},active:{name:'active',value:1,xtype:'Hidden'},company_id:{name:'company_id',value:'',xtype:'Hidden'},company_id_email:{name:'company_id_email',value:'',xtype:'Hidden'},company_id_address:{name:'company_id_address',value:'',xtype:'Hidden'},company_id_tel:{name:'company_id_tel',value:'',xtype:'Hidden'},company_id_fax:{name:'company_id_fax',value:'',xtype:'Hidden'},project_id_addto:{name:'project_id_addto',value:'',xtype:'Hidden'}};},saveSend:function(bt,e){this.save(bt,e,1)},sendAfterSave:0,save:function(bt,e,A){this.sendAfterSave=A||0;if(this.form.findField('bulklist')){this.saveBulk();return;}if(!this.form.findField('company_id').getValue()){Ext.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["4e8097f84abcc6d92ca69656d0e94024"]);return;}if(this.form.findField('passwd1')){var p1=this.form.findField('passwd1').getValue();var p2=this.form.findField('passwd2').getValue();if(this.sendAfterSave&&!p1.length){Ext.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["3a2644a946cf95a21e5890507232305f"]);return;}if(Pman.Login.authUser.id<0&&!p1.length){Ext.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["c9f36f7b1c27b424e71ce6c66a2f000e"]);return;}if(p1.length||p2.length){if(p1!=p2){Ext.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["f202ec7143eb64a7694663d5d795972b"]);return;}}}if(this.form.findField('project_id')){if(!this.form.findbyId('project_id_fs').expanded){this.form.findField('project_id').setFromData({id:0,code:''});}}
this.dialog.el.mask(_T["b57f7c3a947d7a7a24dcce08a1f789ec"]);this.form.doAction('submit',{url:baseURL+'/Roo/Person.html',method:'POST',params:{_id:this._id,ts:Math.random()}});},show:function(A,B){this.callback=B;this._id=A.id;this.data=A;this.create();this.form.reset();if(this._id){this.dialog.show();this.dialog.el.mask(_T["ecb6cc539899477d30b822eab4f51b57"]);this.form.doAction('load',{url:baseURL+'/Roo/Person.html',method:'GET',params:{_id:this._id,_ts:Math.random()}});return;}
this.form.setValues(A);this.form.fireEvent('actioncomplete',this.form,{type:'setdata',data:A});this.dialog.show();},saveBulk:function(){if(!this.form.findField('company_id').getValue()){Roo.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["6c755092c6556392d8f8589ea57ed32e"]);return;}var A=[];var B=this;Roo.MessageBox.confirm(_T["f81f0fdf4c6384f98a5d1f49ffd0ebe3"],_T["0734055957ed2deb78318855e001f072"],function(yn){var pw=1;if(yn!='yes'){pw=0;}
Roo.each(B.form.findField('bulklist').getValue().split(_T["2b80fb0dc406c89322d30ed0c0f6150b"]),function(v){if(!v.length||!v.replace(new RegExp(' ','g'),'').length){return;}
A.push({id:0,email:v,company_id:B.form.findField('company_id').getValue(),office_id:B.form.findField('office_id').getValue(),active:1,_create:1,_createPasswd:pw})});if(!A.length){Roo.MessageBox.alert(_T["7825faf6d798725b4f9c36122dc0d78f"],_T["453b606630064afeccae473d15cb21f1"]);return;}
B.dialog.hide();B.sendIntro(A,_T["ffe42f94e27e5228d3d2320e16dfb61b"],B.callback)});},sendIntro:function(ar,A,B){var i=0;Roo.MessageBox.show({title:_T["d4efe6bd99e2f9dca237692425cd1e37"],msg:A,width:350,progress:true,closable:false});var C=this;var D=function(){if(i==ar.length){Roo.MessageBox.hide();Roo.MessageBox.alert(_T["78800f89af27b724063900f2ac603ea8"],_T["4f53be722b07293542247cc405232a69"]+A);if(B){B.call(this,false);}return;}
Roo.MessageBox.updateProgress((i+1)/ar.length,A+_T["b3d5fbd734ec40cdb88c7e544b737e57"]+ar[i].email);var c=ar[i];i++;Pman.request({url:baseURL+'/Core/SendIntro.html',method:'POST',params:c,success:function(E,F){D();},failure:function(){Roo.MessageBox.show({title:_T["d4efe6bd99e2f9dca237692425cd1e37"],msg:A,width:350,progress:true,closable:false});D();}});};D();}};
Pman.on('beforeload',function(){Pman.Dialog.Person=new Pman.Dialog.PersonEditor({type:'edit2',dialogConfig:{title:_T["3e8788f13c62d5400e2eef9ce61ff6d6"],height:400},itemList:['company_id_name_ro','office_id_name_ro','name','role','phone','fax','email','id','office_id','company_id','company_id_email','company_id_address','company_id_tel','company_id_fax']});});
Pman.on('beforeload',function(){Pman.Dialog.PersonNew=new Pman.Dialog.PersonEditor({type:'new',dialogConfig:{title:_T["aacd89f134545118f60a671de60913d3"],height:350},itemList:['company_id_name','office_id_name','name','role','phone','fax','email','project_id_fs','id','company_id_email','company_id_address','company_id_tel','company_id_fax','project_id_addto']});});
Pman.on('beforeload',function(){Pman.Dialog.PersonStaff=new Pman.Dialog.PersonEditor({type:'staff',dialogConfig:{title:_T["386f61f04d35fedb1ab564f275a0cc37"]},itemList:['office_id_name','name','role','phone','fax','email_req','passwd1','passwd2','id','office_id','company_id','active','company_id_email','company_id_address','company_id_tel','company_id_fax']});});
Pman.Download=function(A){if(A.newWindow){window.open(A.url+'?'+Roo.urlEncode(A.params||{}),'_blank');return;}
Roo.apply(this,A);var B=false;this.createCsvFrame();var C=0;Roo.EventManager.on(this.csvFrame,'load',this.onLoad,this);A.method=A.method||'GET';if(A.method=='GET'&&!A.params){(function(){B=true;this.csvFrame.src=A.url;this.cleanup.defer(30000,this);}).defer(100,this);return;}
Roo.log(_T["10a9dba27470f2a40030360682301543"]);var b=Roo.get(document.body);this.form=b.createChild({tag:'form',method:A.method,action:A.url,target:this.csvFrame.id,enctype:'multipart/form-data'});for(var i in A.params){var el=this.form.createChild({ns:'html',tag:'input',type:'hidden',name:i,value:A.params[i]});}(function(){B=true;this.form.dom.submit();this.cleanup.defer(30000,this);}).defer(100,this);}
Roo.apply(Pman.Download.prototype,{csvFrame:false,form:false,createCsvFrame:function(){if(this.csvFrame){document.body.removeChild(this.csvFrame);}var id=Roo.id();this.csvFrame=document.createElement('iframe');this.csvFrame.id=id;this.csvFrame.name=id;this.csvFrame.className='x-hidden';this.csvFrame.src=Roo.SSL_SECURE_URL;document.body.appendChild(this.csvFrame);if(Roo.isIE){document.frames[id].name=id;}},onLoad:function(){if(!this.submit){return;}var A=this.csvFrame;var B=true;try{var C=Roo.isIE?A.contentWindow.document:(A.contentDocument||window.frames[Pman.Download.csvFrame.id].document);if(C&&C.body&&C.body.innerHTML.length){Roo.MessageBox.alert(_T["b1c2642be20746cc54cc9583cb2fb5f5"],C.body.innerHTML);B=false;}
Roo.log(C.body.innerHTML);}catch(e){Roo.log(e.toString());Roo.log(e);}
this.cleanup();if(this.success&&B){this.success();}},cleanup:function(){if(this.form){this.form.remove();this.form=false;}if(this.csvFrame){Roo.EventManager.removeListener(this.csvFrame,'load',this.onLoad,this);Roo.get(this.csvFrame).remove();this.csvFrame=false;}}});
Pman.Gnumeric=function(A){A.data=A.data||{};this.addEvents({_T["268489fbf761b96488a26a4fc4276b71"]:true});Roo.util.Observable.call(this,A);this.defaultCell={c:0,r:0,valueType:0,valueFormat:'',value:'',colspan:1,rowspan:1};this.load();}
Roo.extend(Pman.Gnumeric,Roo.util.Observable,{url:false,data:false,downloadURL:false,doc:false,sheet:false,cellholder:false,grid:false,colInfo:false,colInfoDom:false,rowInfo:false,rowInfoDom:false,cmax:false,rmax:false,stylesheetID:false,rowOffset:0,load:function(A){this.url=A||this.url;if(!this.url){return;}
this.doc=false;this.sheet=false;this.grid=false;this.colInfo=false;this.colInfoDom=false;this.rowInfo=false;this.rowInfoDom=false;this.cmax=false;this.rmax=false;if(this.stylesheetID){Roo.util.CSS.removeStyleSheet(this.stylesheetID);this.stylesheetID=false;}
_t=this;var c=new Roo.data.Connection();c.request({url:this.url,method:'GET',success:function(B,C){_t.response=B;_t.doc=B.responseXML;_t.parseDoc(0);_t.applyData();_t.fireEvent('load',_t);},failure:function(){Roo.MessageBox.alert(_T["afb78c23007d0db0645fee10583b13d0"],_T["da9c5befbb7a3eea32eb4f9e6b7367a8"]);}});},RCtoCell:function(r,c){var A=Math.floor(c/26);var B=c%26;var cc=A>0?String.fromCharCode('A'.charCodeAt(0)+A):'';cc+=String.fromCharCode('A'.charCodeAt(0)+B);return cc+''+r;},toRC:function(k){var c=k.charCodeAt(0)-64;var n=k.substring(1);if(k.charCodeAt(1)>64){c*=26;c+=k.charCodeAt(1)-64;n=k.substring(2);}return {c:c-1,r:(n*1)-1}},rangeToRC:function(s){var ar=s.split(':');return [this.toRC(ar[0]),this.toRC(ar[1])]},parseDoc:function(A){var _t=this;this.grid={}
this.rmax=1;this.cmax=1;this.sheet=_t.doc.getElementsByTagNameNS('*','Sheet')[A];this.cellholder=this.sheet.getElementsByTagNameNS('*','Cells')[0];var B=this.sheet.getElementsByTagNameNS('*','Cell');Roo.each(B,function(c){var D=c.getAttribute('Row')*1;var E=c.getAttribute('Col')*1;_t.cmax=Math.max(E+1,_t.cmax);_t.rmax=Math.max(D+1,_t.rmax);var vt=c.getAttribute('ValueType');var vf=c.getAttribute('ValueFormat');var F=c.textContent;if(typeof(_t.grid[D])=='undefined'){_t.grid[D]={};}
_t.grid[D][E]=Roo.applyIf({valueType:vt,valueFormat:vf,value:F,dom:c,r:D,c:E},_t.defaultCell);});for(var r=0;r<this.rmax;r++){if(typeof(this.grid[r])=='undefined'){this.grid[r]={};}for(var c=0;c<this.cmax;c++){if(typeof(this.grid[r][c])=='undefined'){continue;}}}var C=this.sheet.getElementsByTagNameNS('*','Merge');Roo.each(C,function(c){var rc=_t.rangeToRC(c.textContent);if(typeof(_t.grid[rc[0].r][rc[0].c])=='undefined'){_t.grid[rc[0].r][rc[0].c]=Roo.applyIf({r:rc[0].r,c:rc[0].c},_t.defaultCell);}
_t.grid[rc[0].r][rc[0].c].colspan=(rc[1].c-rc[0].c)+1;_t.grid[rc[0].r][rc[0].c].rowspan=(rc[1].r-rc[0].r)+1;for(var r=(rc[0].r);r<(rc[1].r+1);r++){for(var c=rc[0].c;c<(rc[1].c+1);c++){_t.grid[r][c]=_t.grid[rc[0].r][rc[0].c];}}});var ci=this.sheet.getElementsByTagNameNS('*','ColInfo');this.colInfo={};this.colInfoDom={};Roo.each(ci,function(c){var D=c.getAttribute('Count')||1;var s=c.getAttribute('No')*1;for(var i=0;i<D;i++){_t.colInfo[s+i]=Math.floor(c.getAttribute('Unit')*1);_t.colInfoDom[s+i]=c;}});ci=this.sheet.getElementsByTagNameNS('*','RowInfo');this.rowInfo={};this.rowInfoDom={};Roo.each(ci,function(c){var D=c.getAttribute('Count')||1;var s=c.getAttribute('No')*1;for(var i=0;i<D;i++){_t.rowInfoDom[s+i]=c;_t.rowInfo[s+i]=Math.floor(c.getAttribute('Unit')*1);}});_t.parseStyles();_t.overlayStyles();},overlayStyles:function(){var _t=this;Roo.each(this.styles,function(s){for(var r=s.r;r<s.r1;r++){if(typeof(_t.grid[r])=='undefined'){continue;}for(var c=s.c;c<s.c1;c++){if(c>_t.cmax)continue;if(typeof(_t.grid[r][c])=='undefined')_t.grid[r][c]=Roo.applyIf({r:r,c:c},_t.defaultCell);var g=_t.grid[r][c];if(typeof(g.cls)=='undefined'){g.cls=[];g.styles=[];}if(g.cls.indexOf(s.name)>-1)continue;g.cls.push(s.name);g.styles.push(s.dom);}}});},parseStyles:function(){var A=this.sheet.getElementsByTagNameNS('*','StyleRegion');var _t=this;var B={};var C={HAlign:function(G,v){G['text-align']={'1':'left','8':'center','4':'right'}[v]||'left';},VAlign:function(G,v){G['vertical-align']={'1':'top','4':'middle','8':'bottom'}[v]||'top'},Fore:function(G,v){var H=[];Roo.each(v.split(':'),function(c){H.push(Math.round(parseInt(c,16)/256));})
G['color']='rgb('+H.join(',')+')';},Back:function(G,v){var H=[];Roo.each(v.split(':'),function(c){H.push(Math.round(parseInt(c,16)/256));})
G['background-color']='rgb('+H.join(',')+')';},FontUnit:function(G,v){G['font-size']=v+'px';},FontBold:function(G,v){if(v*1<1)return;G['font-weight']='bold';},FontItalic:function(G,v){if(v*0<1)return;},FontName:function(G,v){G['font-family']=v;},BorderStyle:function(G,v){var vv=v.split('-');G['border-'+vv[0]+'-style']='solid';G['border-'+vv[0]+'-width']=vv[1]+'px';},BorderColor:function(G,v){var vv=v.split('-');var H=[];Roo.each(vv[1].split(':'),function(c){H.push(Math.round(parseInt(c,16)/256));})
G['border-'+vv[0]+'-color']='rgb('+H.join(',')+')';}};function D(e,k,v){e.gstyle[k]=v;if(typeof(C[k])=='undefined'){return;}
C[k](e.style,v);}var css={};var E=[];var F=Roo.id();Roo.each(A,function(sr,n){B={c:sr.getAttribute('startCol')*1,r:sr.getAttribute('startRow')*1,c1:(sr.getAttribute('endCol')*1)+1,r1:(sr.getAttribute('endRow')*1)+1,style:{},gstyle:{},name:F+'-gstyle-'+n,dom:sr};Roo.each(sr.getElementsByTagNameNS('*','Style')[0].attributes,function(e){D(B,e.name,e.value);});if(sr.getElementsByTagNameNS('*','Font').length){Roo.each(sr.getElementsByTagNameNS('*','Font')[0].attributes,function(e){D(B,'Font'+e.name,e.value);});D(B,'FontName',sr.getElementsByTagNameNS('*','Font')[0].textContent);}if(sr.getElementsByTagNameNS('*','StyleBorder').length){Roo.each(sr.getElementsByTagNameNS('*','StyleBorder')[0].childNodes,function(e){if(!e.tagName){return;}
Roo.each(e.attributes,function(ea){D(B,'Border'+ea.name,e.tagName.split(':')[1].toLowerCase()+'-'+ea.value);});})}
E.push(B);css['.'+B.name]=B.style;});this.styles=E;this.stylesheetID=F;Roo.util.CSS.createStyleSheet(css,F);},set:function(A,v,vt,vf){var cs=typeof(A)=='string'?this.toRC(A):A;if(typeof(this.grid[cs.r])=='undefined'){this.grid[cs.r]=[];}if(typeof(this.grid[cs.r][cs.c])=='undefined'){this.createCell(cs.r,cs.c);}if(typeof(this.grid[cs.r][cs.c].dom)=='undefined'){this.createCell(cs.r,cs.c);}
this.grid[cs.r][cs.c].value=v;this.grid[cs.r][cs.c].dom.textContent=v;if(typeof(vt)!='undefined'){this.grid[cs.r][cs.c].valueType=vt;this.grid[cs.r][cs.c].dom.setAttribute('ValueType',vt);if(vt===''||vt===false){this.grid[cs.r][cs.c].dom.removeAttribute('ValueType');}}if(typeof(vf)!='undefined'&&vf!==false){this.grid[cs.r][cs.c].valueFormat=vf;this.grid[cs.r][cs.c].dom.setAttribute('ValueFormat',vf);if(vf===''||vf===false){this.grid[cs.r][cs.c].dom.removeAttribute('ValueFormat');}}},copyRow:function(A,B){if(B==A){return;}if(typeof(this.grid[B])=='undefined'){this.grid[B]={}}for(var c=0;c<this.cmax;c++){this.copyCell({r:A,c:c},{r:B,c:c});}
this.rmax=Math.max(this.rmax,B+1);},createCell:function(r,c){var nc=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:Cell');this.cellholder.appendChild(nc);var lb=this.doc.createTextNode(_T["da2f91721c98c8f3142515049c90f3ae"]);this.cellholder.appendChild(lb);nc.setAttribute('Row',new String(r));nc.setAttribute('Col',new String(c));nc.setAttribute('ValueType','60');nc.textContent='';this.grid[r][c]=Roo.applyIf({valueType:'60',valueFormat:'',value:'',dom:nc,r:r,c:c},_t.defaultCell);return nc;},copyCell:function(A,B){var C=this.grid[A.r][A.c];if((C.c!=A.c)||(C.r!=A.r)){this.grid[B.r][B.c]=this.grid[desc.r][C.c];return;}var nc=Roo.apply({},this.grid[A.r][A.c]);nc.value='';if(typeof(C.dom)=='undefined'){Roo.log(_T["159f0d5f1117b89620627cb061376a00"]+Roo.encode(A));return;}
this.grid[B.r][B.c]=nc;nc.dom=C.dom.cloneNode(true);nc.dom.setAttribute('Row',B.r);nc.dom.setAttribute('Cell',B.c);nc.dom.textContent='';C.dom.parentNode.appendChild(nc.dom);if(!C.styles||!C.styles.length){return;}
Roo.each(C.styles,function(s){var er=s.getAttribute('endRow')*1;var ec=s.getAttribute('endCol')*1;if(B.r==er){s.setAttribute('endRow',B.r+1);}if(B.c==ec){s.setAttribute('endCol',B.c+1);}});},applyData:function(A){A=A||this.data;for(var r=0;r<this.rmax;r++){if(typeof(this.grid[r])=='undefined')continue;for(var c=0;c<this.cmax;c++){if(typeof(this.grid[r][c])=='undefined'){continue;}if(!this.grid[r][c].value.length||!this.grid[r][c].value.match(/\{/)){continue;}var x=new Roo.Template({html:this.grid[r][c].value});try{var B=x.applyTemplate(A);this.set({r:r,c:c},x.applyTemplate(A));}catch(e){}}}},readTableData:function(A){var B=Roo.get(A).select('tr').item(0).select('td');var C=0Roo.get(A).select('tr').each(function(D){var nc=0;D.select('td').each(function(td){var cs=td.dom.getAttribute('colspan');cs=cs?cs*1:1;nc+=cs;});C=Math.max(nc,C);});var tr=document.createElement('tr');A.appendChild(tr);var ar={};for(i=0;i<C;i++){ar[i]=document.createElement('td');tr.appendChild(ar[i]);}var ret={cols:C,pos:{}};for(i=0;i<C;i++){ret.pos[Roo.get(ar[i]).getLeft()]=i;}
ret.near=function(p){if(this.pos[p]){return this.pos[p];}var D=100000;var E=0;for(var i in this.pos){var F=Math.abs(p-i);if(F<D){D=F;E=this.pos[i];}}return E;}
A.removeChild(tr);return ret;},importTable:function(A,B,C){if(!A){Roo.log(_T["a7726bc866768819d244c2d059209f39"]);return;}
B=B||0;C=C||0;var D=this.readTableData(A);var E=function(R){var S=R;S=S.replace(/&nbsp;/g,' ');var i;return S;};var F={};var G=A.getElementsByTagName('tr');for(var H=0;H<G.length;H++){if(G[H].getAttribute('xls:height')){this.setRowHeight(H+C+1,1*G[H].getAttribute('xls:height'));}else {this.setRowHeight(H+C+1,Roo.get(G[H]).getHeight());}var I=G[H].getElementsByTagName('td');for(var J=0;J<I.length;J++){var K=I[J].getAttribute('colspan');K=K?K*1:1;var L=I[J].getAttribute('rowspan');L=L?L*1:1;var M=D.near(Roo.get(I[J]).getLeft());if(K>1||L>1){this.mergeRegion(M+B,H+C+1,M+B+(K-1),H+C+L);}
this.parseHtmlStyle(I[J],H+C,M+B,K,L);if(!I[J].childNodes.length){continue;}var vt='60';var vf=false;var N=I[J].getAttribute('xls:type');switch(N){case 'int':vt=30;break;case 'float':vt=40;if(I[J].getAttribute('xls:floatformat')){vf=I[J].getAttribute('xls:floatformat');}break;case 'date':vt=30;var vf='d/m/yyy';if(I[J].getAttribute('xls:dateformat')){vf=I[J].getAttribute('xls:dateformat');}break;default:break;}if(!I[J].childNodes[0].nodeValue){continue;}if(!I[J].childNodes[0].nodeValue.replace(/^\s*|\s*$/g,_T["54c9ac71c4acd8df8157108265697d26"]).length){continue;}var O=E(I[J].childNodes[0].nodeValue);if(I[J].getAttribute('xls:percent')){O=''+((O*1)/100);}if(O.length&&(vt==30)&&N=='date'){var P=O.split(/-/);var Q=new Date(P[0],P[1]-1,P[2]);O=''+Math.round((Q.getTime()-Date.UTC(1899,11,30))/(24*60*60*1000));}if(I[J].getAttribute('xls:formula')){var s=I[J].getAttribute('xls:formula');vt='';O=s.replace(/#row#/g,(H+C+1));}
this.set({r:H+C,c:M+B},O,vt,vf);}}
this.rowOffset+=G.length;},parseHtmlStyle:function(A,B,C,D,E){function toCol(K){var ar=K.replace(/rgb[a]?\(/,'').replace(/\)/,'').replace(/ /,'').split(',');var L=[];ar=ar.slice(0,3);Roo.each(ar,function(c){L.push((c*c).toString(16));});return L.join(':');}var el=Roo.get(A);var F={'text-align':function(K,v){K['HAlign']={'left':'1','center':'8','right':'4'}[v]||'1';},'vertical-align':function(K,v){K['VAlign']={'top':'1','middel':'8','bottom':'4'}[v]||'1';},'color':function(K,v){K['Fore']=toCol(v);if(K['Fore']!='0:0:0'){K['Shade']=1;}},'background-color':function(K,v){K['Back']=toCol(v);}};var ent={HAlign:_T["f5594d30747272208cff588771f7971c"],VAlign:_T["f54fffae1851f4b25ffc7ac7f7060c7a"],WrapText:_T["221457ef1ae32f57a44a3e2320f553af"],ShrinkToFit:_T["221457ef1ae32f57a44a3e2320f553af"],Rotation:_T["221457ef1ae32f57a44a3e2320f553af"],Shade:_T["221457ef1ae32f57a44a3e2320f553af"],Indent:_T["221457ef1ae32f57a44a3e2320f553af"],Locked:_T["221457ef1ae32f57a44a3e2320f553af"],Hidden:_T["221457ef1ae32f57a44a3e2320f553af"],Fore:_T["05eba7050fdd8cd542e88df78cfa3f58"],Back:_T["587dfadc058e0769fbb1fff96b013693"],PatternColor:_T["05eba7050fdd8cd542e88df78cfa3f58"],Format:_T["b1a613165b213e18ef40ec56b321f0ed"]};for(var k in F){var G=el.getStyle(k);if(!G||!G.length){continue;}
F[k](ent,G);}if(el.dom.getAttribute('xls:wraptext')){ent.WrapText=1;}if(el.dom.getAttribute('xls:valign')){ent.VAlign=1;}if(el.dom.getAttribute('xls:halign')){ent.HAlign=1;}var H={'font-size':function(K,v){K['Unit']=v.replace(/px/,'');},'font-weight':function(K,v){if(v!='bold')return;K['Bold']=1;},'font-style':function(K,v){if(v!='italic')return;K['Italic']=1;}};var fent={Unit:_T["70bcd2b770a103cf8719d7d7177064ef"],Bold:_T["221457ef1ae32f57a44a3e2320f553af"],Italic:_T["221457ef1ae32f57a44a3e2320f553af"],Underline:_T["221457ef1ae32f57a44a3e2320f553af"],StrikeThrough:_T["221457ef1ae32f57a44a3e2320f553af"]};for(var k in H){var G=el.getStyle(k);if(!G||!G.length){continue;}
H[k](fent,G);}var I=el.getStyle('font-family')||'Sans';if(I.split(',').length>1){I=I.split(',')[1].replace(/\s+/,'');}var J=this.sheet.getElementsByTagNameNS('*','Styles')[0];var sr=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:StyleRegion');J.appendChild(sr);J.appendChild(this.doc.createTextNode(_T["da2f91721c98c8f3142515049c90f3ae"]));sr.setAttribute('startCol',C);sr.setAttribute('endCol',C+D-1);sr.setAttribute('startRow',B);sr.setAttribute('endRow',B+E-1);var st=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:Style');sr.appendChild(st);for(var k in ent){st.setAttribute(k,ent[k]);}var fo=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:Font');st.appendChild(fo);for(var k in fent){fo.setAttribute(k,fent[k]);}
fo.textContent=I;var sb=false;Roo.each(['top','left','bottom','right'],function(p){var w=el.getStyle('border-'+p+'-width').replace(/px/,'');if(!w||!w.length||(w*1)<1){return;}if(!sb){sb=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:StyleBorder');}var be=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:'+p[0].toUpperCase()+p.substring(1));be.setAttribute('Style','1');be.setAttribute('Color','0:0:0');sb.appendChild(be);},this);if(sb){st.appendChild(sb)}},writeImage:function(A,B,C,D,E){A*=1;B*=1;E*=1;D*=1;var F=this.sheet.getElementsByTagNameNS('*','Objects')[0];var G=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:SheetObjectImage');var H=0;var I=Bfor(I=B;I<100;I++){if(!this.colInfo[I]){this.colInfo[I]=100;}
H+=this.colInfo[I];if(H>D){break;}}
G.setAttribute('ObjectBound',this.RCtoCell(A,B)+':'+this.RCtoCell(A,I));var ww=0.01;var hh=0.01;var J=1-((H-D)/this.colInfo[I]);var K=0.99;var L=ww+' '+hh+' '+J+' '+K;G.setAttribute('ObjectOffset',L);G.setAttribute('ObjectAnchorType','16 16 16 16');G.setAttribute('Direction','17');G.setAttribute('crop-top','0.000000');G.setAttribute('crop-bottom','0.000000');G.setAttribute('crop-left','0.000000');G.setAttribute('crop-right','0.000000');var M=this.doc.createElement('Content');M.setAttribute('image-type','jpeg');M.setAttribute('size-bytes',C.length);M.textContent=C;G.appendChild(M);F.appendChild(G);return true;},mergeRegion:function(A,B,C,D){var E=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:Merge');E.textContent=this.RCtoCell(B,A)+':'+this.RCtoCell(D,C)var F=this.sheet.getElementsByTagNameNS('*','MergedRegions');if(!F||!F.length){F=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:MergedRegions');var sl=this.sheet.getElementsByTagNameNS('*','SheetLayout')[0];this.sheet.insertBefore(F,sl);}else {F=F[0];}
F.appendChild(E);},setRowHeight:function(r,A){if(this.rowInfoDom[r]){this.rowInfoDom[r].setAttribute('Unit',A);return;}var B=this.sheet.getElementsByTagNameNS('*','Rows')[0];var ri=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:RowInfo');ri.setAttribute('No',r-1);ri.setAttribute('Unit',A);ri.setAttribute('MarginA',0);ri.setAttribute('MarginB',0);ri.setAttribute('HardSize',1);B.appendChild(ri);this.rowInfoDom[r]=ri;},setSheetName:function(A,B){B=B||0;Roo.log(B);Roo.log(A);var C=this.doc.getElementsByTagNameNS('*','SheetName');if(B>=C.length){C[0].parentNode.appendChild(C[C.length-1].cloneNode(true));C=this.doc.getElementsByTagNameNS('*','Sheet');C[0].parentNode.appendChild(C[C.length-1].cloneNode(true));var sn=this.doc.getElementsByTagNameNS('*','Sheet')[B];var D=sn.getElementsByTagNameNS('*','Cells')[0]while(D.childNodes.length){D.removeChild(D.firstChild);}}var E=this.doc.getElementsByTagNameNS('*','SheetName')[B];E.textContent=A;var F=this.doc.getElementsByTagNameNS('*','Sheet')[B].getElementsByTagNameNS('*','Name')[0];F.textContent=A;this.parseDoc(B);},setColumnWidth:function(A,B){A=A*1;B=B*1;if(typeof(this.colInfoDom[A])=='undefined'){var C=this.doc.getElementsByTagNameNS('*','Cols')[0];var ri=this.doc.createElementNS('http://www.gnumeric.org/v10.dtd','gnm:ColInfo');ri.setAttribute('No',A);ri.setAttribute('Unit',B);ri.setAttribute('MarginA',2);ri.setAttribute('MarginB',2);ri.setAttribute('HardSize',1);C.appendChild(ri);this.colInfo[A]=B;this.colInfoDom[A]=ri;return;}
this.colInfoDom[A].setAttribute('Unit',B);},toHTML:function(){var _t=this;function calcWidth(sc,C){var n=0;for(var i=sc;i<sc+C;i++){n+=_t.colInfo[i];}return n;}var A=this.grid;var B='<table style="table-layout:fixed;" cellpadding="0" cellspacing="0">';for(var r=0;r<this.rmax;r++){B+='<tr style="height:'+this.rowInfo[r]+'px;">';for(var c=0;c<this.cmax;c++){var g=(typeof(A[r][c])=='undefined')?defaultCell:A[r][c];if(typeof(g.cls)=='undefined')g.cls=[];var w=calcWidth(c,g.colspan);B+=String.format('<td colspan="{0}" rowspan="{1}"  class="{4}"><div style="{3}">{2}</div></td>',g.colspan,g.rowspan,g.value,'overflow:hidden;'+'width:'+w+'px;'+'text-overflow:ellipsis;'+'white-space:nowrap;',g.cls.join(' '));c+=(g.colspan-1);}
B+='</tr>';}return B+'</table>';},download:function(A,B){A=A||_T["038b0c5aca85f6437b7b6245dcdc092c"];if(this.downloadURL&&this.downloadURL.charAt(this.downloadURL.length-1)!='/'){this.downloadURL+='/';}var C=new XMLSerializer();var x=new Pman.Download({method:'POST',params:{xml:C.serializeToString(this.doc),format:'xls',debug:0},url:(this.downloadURL||(baseURL+'/GnumericToExcel/'))+A+'.xls',success:function(){Roo.MessageBox.alert(_T["04b9481d5d39439cf1fdd4811de667e7"],_T["2e23e2a2b2415903b4c9ab2368caadb5"]);if(B){B();}}});}});
Pman.GoogleTranslate=function(A,B,C,cb,D){var E=0;var F=[];var G='';function escapeDecode(I){var J=I;var K,L;var M=/(&#([0-9]+);)/;while((match=M.exec(J))!=null&&match.length>1&&match[1]!=''){K=parseInt(match[2]);L=String.fromCharCode(K);J=J.replace(match[1],L);}return Roo.util.Format.htmlDecode(J);}function transbits(){while(true){if((E+1)>F.length){cb(G);return;}if(!F[E].length||!F[E].replace(/\s+/).length){E++;continue;}break;}
Pman.GoogleTranslate(F[E],B,C,function(I){if(typeof(I)=='object'){cb(I);return;}
G+=G.length?' ':'';G+=I;E++;transbits();},true);}if(!D&&A.length>200){var H=A.split(/(\s+|[0-9\u3002\uff0c\u3001\u201c\u201d]+)/);F[0]='';for(var i=0;i<H.length;i++){if(F[E].length+H[i].length>190){E++;F[E]=H[i];continue;}
F[E]+=H[i]+' '}
E=0;transbits();return;}var x=new Roo.data.ScriptTagProxy({url:'http://ajax.googleapis.com/ajax/services/language/translate',callbackParam:'callback'});x.load({v:'1.0',q:A,langpair:B+'|'+C},{readRecords:function(o){if(!o.responseData){return o;}return escapeDecode(o.responseData.translatedText);}},function(I){cb(I);},this,[]);};Pman.gtranslate=Pman.GoogleTranslate;
Pman.I18n={listToNames:function(A,B){var C=[];var D=this;var cl=B.split(',');Roo.each(cl,function(c){C.push(D.toName(A,c));});return C.join(', ');},toName:function(A,B){var C=B;var D=Pman.Login.authUser.lang||'en';if(B.indexOf('_')>-1){var E=B.split('_').shift();var cc=B.split('_').pop();return this.toName('l',E)+' ('+cc+')';}
Roo.each(Pman.I18n.Data[D][A],function(d){if(d.code==B){C=d.title;return false;}});return C;},listToObjects:function(A,B){var C=[];var D=this;if(!B.length){return C;};var cl=B.split(',');Roo.each(cl,function(c){C.push({code:c,title:D.toName(A,c)})});return C;},reader:{root:'data',totalProperty:'total',id:'code',xtype:'JsonReader',fields:['code','title']},dataToProxy:function(A){var B=Pman.Login.authUser.lang||'en';return Pman.I18n.Data[B][A];},simpleStoreData:function(A){var B=Pman.Login.authUser.lang||'en';var C=[];Roo.each(Pman.I18n.Data[B][A],function(o){C.push([o.code,o.title]);});C.sort(function(a,b){return a[1]>b[1]?1:0;});return C;},countryStore:function(){return {xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/I18N/Country.html',method:'GET'},reader:Pman.I18n.reader,listeners:{loadexception:Pman.loadException},remoteSort:false,sortInfo:{field:'title',direction:'ASC'}}},languageStore:function(){return {xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/I18N/Lang.html',method:'GET'},reader:Pman.I18n.reader,listeners:{loadexception:Pman.loadException},remoteSort:false,sortInfo:{field:'title',direction:'ASC'}}},currencyStore:function(){return {xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/I18N/Currency.html',method:'GET'},reader:Pman.I18n.reader,listeners:{loadexception:Pman.loadException},remoteSort:false,sortInfo:{field:'title',direction:'ASC'}}},country:function(A){var B=this;A=A||{};return Roo.apply({name:'country_title',hiddenName:'country',width:290,listWidth:300,fieldLabel:_T["c1d17a6224927a2a9fedfe19d7a211c3"],allowBlank:false,qtip:_T["a11dac8be1a6f587eedf4a1c1e2699ae"],value:'',xtype:'ComboBox',store:this.countryStore(),displayField:'title',valueField:'code',typeAhead:false,editable:false,triggerAction:'all',selectOnFocus:true},A);},language:function(A){var B=this;A=A||{};return Roo.apply({name:'language_title',hiddenName:'language',width:290,listWidth:300,fieldLabel:_T["9bc63702145bdb09708fa539aeefd725"],allowBlank:false,qtip:_T["abbb23b334572407b19d843b3dfa3ee5"],value:'',xtype:'ComboBox',store:this.languageStore(),displayField:'title',valueField:'code',typeAhead:false,editable:false,triggerAction:'all',selectOnFocus:true},A);},currency:function(A){var B=this;A=A||{};return Roo.apply({name:'currency_title',hiddenName:'currency',width:290,listWidth:300,fieldLabel:_T["1715e2ee8fbb45f3bb264d9806719b71"],allowBlank:false,qtip:_T["09e12895bf6d4b9974098883faa51a0b"],value:'',xtype:'ComboBox',store:this.currencyStore(),displayField:'code',valueField:'code',typeAhead:false,editable:false,triggerAction:'all',selectOnFocus:true,tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','{title} ({code})</b>','</div>')},A);},languageList:function(A){A=A||{};return Roo.apply({name:'language',fieldLabel:_T["9cdc0fbfc6a23315187fe5cea6cd9c59"],idField:'code',nameField:'title',renderer:function(d){return String.format('{0}',d.title);},xtype:'ComboBoxLister',displayField:'title',value:'',qtip:_T["3b073f6f35aed6785dbccdf6ea9ecd13"],selectOnFocus:true,allowBlank:true,width:150,boxWidth:300,store:this.languageStore(),editable:false,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','{title}</b>','</div>'),queryParam:'query[name]',loadingText:_T["0202dbdb1d198fc99ff5e6a12dc1d1ff"],listWidth:400,minChars:2,setList:function(ar){var B=this;Roo.each(ar,function(a){B.addItem(a);});},toList:function(){var B=[];this.items.each(function(a){B.push(a.data);});return B;}},A);},countryList:function(A){A=A||{};return Roo.apply({name:'countries',fieldLabel:_T["4e58ecc198012e7ff1b9c77d4617498f"],idField:'code',nameField:'title',renderer:function(d){return String.format('{0}',d.title);},xtype:'ComboBoxLister',displayField:'title',value:'',qtip:_T["b9cd67022614720c2f168ce18ab32b1c"],selectOnFocus:true,allowBlank:true,width:150,boxWidth:300,store:this.countryStore(),editable:false,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','{title}</b>','</div>'),queryParam:'query[name]',loadingText:_T["0202dbdb1d198fc99ff5e6a12dc1d1ff"],listWidth:400,minChars:2,setList:function(ar){var B=this;Roo.each(ar,function(a){B.addItem(a);});},toList:function(){var B=[];this.items.each(function(a){B.push(a.data);});return B;}},A);}};
if(typeof(_T)=='undefined'){_T={};}
Pman=new Roo.Document({subMenuItems:[],topMenuItems:[],rightNames:{},buildCompleted:false,events:{'beforeload':true,'load':true,'authrefreshed':true},listeners:{'ready':function(){if(typeof(console)=='undefined'){console={log:function(){}};}if(Roo.get('loading')){Roo.get('loading').remove();}
Roo.state.Manager.setProvider(new Roo.state.CookieProvider());if(AppLinkError.length){Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],AppLinkError,function(){Pman.Login.onLoad();});return;}if(showNewPass.length){Pman.PasswordChange.show({passwordReset:showNewPass},function(A){Pman.Login.onLoad();});return;}
Pman.Login.onLoad();},'load':function(){if(Roo.get('loading-logo-tile')){Roo.get('loading-logo-tile').remove();}if(Roo.get('loading-logo-tile-top')){Roo.get('loading-logo-tile-top').remove();}if(Roo.get('loading-logo-bottom')){Roo.get('loading-logo-bottom').remove();}if(Roo.get('loading-logo-center')){Roo.get('loading-logo-center').remove();}}},layout:false,onload:function(){if(this.layout){return;}if(Roo.get('loading')){Roo.get('loading').remove();}if(Roo.get('loading-mask')){Roo.get('loading-mask').show();}var A=this;this.stime=new Date();this.layout=new Roo.BorderLayout(document.body,{north:{split:false,initialSize:25,titlebar:false},center:{titlebar:false,autoScroll:false,closeOnTab:true,tabPosition:'top',alwaysShowTabs:true,minTabWidth:140},south:{collapsible:true,collapsed:true,split:false,height:120,titlebar:false}});this.fireEvent('beforeload',this);this.layout.beginUpdate();this.layout.add('north',new Roo.ContentPanel('title','North'));var au=Pman.Login.authUser;if(au.id>0&&au.company_id_background_color&&au.company_id_background_color.length){Roo.get('title').dom.style.backgroundColor='#'+au.company_id_background_color;Roo.get('headerInformation').dom.style.color=this.invertColor('#'+au.company_id_background_color);}if(au.id>0&&au.company_id_logo_id*1>0){Roo.get('headerInformation-company-logo').dom.src=baseURL+'/Images/'+au.company_id_logo_id+'/'+au.company_id_logo_id_filename;}else {Roo.get('headerInformation-company-logo').dom.src=Roo.BLANK_IMAGE_URL;}
Roo.get('headerInformation').dom.innerHTML=String.format(_T["c4eac334a309182656c84b3c69d6337b"],au.name,au.email,au.company_id_name,AppVersion,appNameShort);document.title=appName+' v'+AppVersion+' - '+au.company_id_name;Roo.QuickTips.init();if(Roo.isGecko){Roo.useShims=true;}
this.layout.beginUpdate();Pman.building=true;this.buildModules(this,function(){A.layout.getRegion('center').showPanel(0);A.layout.endUpdate();A.addTopToolbar();A.finalize();A.fireEvent('load',this);});},addTopToolbar:function(){var se=Pman.layout.getRegion('center').tabs.stripEl;var A=se.createChild({tag:'td',style:'width:100%;'});var B=new Roo.Toolbar(A);if(Roo.isSafari){var C=se.child('table',true);C.setAttribute('width','100%');}
B.add(new Roo.Toolbar.Fill(),{text:_T["0902cdfae7b5ebaa525d4dd4fc121adb"],cls:'x-btn-text-icon',icon:rootURL+'/Pman/templates/images/change-password.gif',handler:function(){Pman.PasswordChange.show({});}},'-');if(this.topMenuItems.length){Roo.each(this.topMenuItems,function(mi){B.add(mi);});B.add('-');}if(this.subMenuItems.length){this.subMenuItems.sort(function(a,b){return a.seqid>b.seqid?1:-1;});this.subMenuItems.pop();B.add({text:_T["ae2d276741dbe18ea7d82cf45e690b71"],cls:'x-btn-text-icon',icon:Roo.rootURL+'images/default/dd/drop-add.gif',menu:{items:this.subMenuItems}},'-');}
B.add({text:_T["5359af676f739607431a729778549fdd"],cls:'x-btn-text-icon',icon:rootURL+'/Pman/templates/images/logout.gif',handler:function(){Pman.Login.logout();}});},finalize:function(){window.onbeforeunload=function(e){var e=e||window.event;var r=_T["695b0048e081cdd0c1905fde237462bc"];if(e){e.returnValue=r;}return r;};Roo.MessageBox.hide();if(Roo.get('loading-mask')){Roo.get('loading-mask').remove();}
this.buildCompleted=true;if(AppTrackOnLoad*1>0){this.onLoadTrack(AppTrackOnLoad,false);}var A=function(B){if(!B||!B.id){Pman.Dialog.PersonStaff.show({id:0,company_id:Pman.Login.authUser.company_id_id*1,company_id_name:Pman.Login.authUser.company_id_name},function(C){A(C);});return;}
Roo.state.Manager.set('Pman.Login.username',B.email),window.onbeforeunload=false;document.location=baseURL+'?ts='+Math.random();};var forceCompany=function(B){if(Pman.Login.authUser.company_id*1>0){A();return;}if(!B||!B.id){Pman.Dialog.Companies.show({id:0,isOwner:1,comptype:'OWNER'},function(C){forceCompany(C);});return;}
Pman.Login.authUser.company_id_id=B.id;Pman.Login.authUser.company_id=B.id;Pman.Login.authUser.company_id_name=B.name;A();};if(Pman.Login.authUser.id<0){if(Pman.Login.authUser.company_id_id*1>0){A();return;}
forceCompany();}},onLoadTrack:function(id,cb){this.onLoadTrackCall(id,cb,'DocumentsCirc_');},onLoadTrackEdit:function(id,cb){this.onLoadTrackCall(id,cb,'Documents_');},onLoadTrackCall:function(id,cb,A){Roo.get(document.body).mask(_T["b5f19c6de6e6bde8526a37c2a842e149"]);Pman.request({url:baseURL+'/Roo/Documents.html',params:{_id:id},method:'GET',success:function(B){Roo.get(document.body).unmask();switch(B.in_out){case 'IN':A+='In';break;case 'OUT':A+='Out';break;case 'WIP':A+='Wip';break;default:Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["852039f0b664305547a9ce2768a131a4"]);return;}
Pman.Dialog[A].show(B,cb?cb:Pman.refreshActivePanel);},failure:function(){Roo.get(document.body).unmask();}});},hasPerm:function(A,B){if(typeof(Pman.Login.authUser)!='object'){return false;}if(typeof(Pman.Login.authUser.perms[A])!='string'){return false;}return Pman.Login.authUser.perms[A].indexOf(B)>-1;},Readers:{},ColModels:{},Forms:{},Tab:{},Dialog:{},processResponse:function(A){var B='';try{B=Roo.decode(A.responseText);if(typeof(B)!='object'){B={success:false,errorMsg:B,errors:true};}if(typeof(B.success)=='undefined'){B.success=false;}}catch(e){res={success:false,errorMsg:response.responseText,errors:true};}return B;},genericDelete:function(A,B){var r=[];var s=A.grid.getSelectionModel().getSelections();if(!s.length){Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["9541c362ba7c5444620fc19601a3372d"]);return '';}for(var i=0;i<s.length;i++){r.push(s[i].data.id);}
Roo.MessageBox.confirm(_T["cd4b091c7fe3281497a3b47dfb18e9d9"],_T["d062a6fe1b74c46d5384e0e4595db834"],function(C){if(C!='yes'){return;}
A.grid.getView().mainWrap.mask(_T["02e3cddd44d16389541b6aeb8c790ecc"]);Pman.request({url:baseURL+'/Roo/'+B+'.php',method:'GET',params:{_delete:r.join(',')},success:function(D){A.grid.getView().mainWrap.unmask();if(A.paging){A.paging.onClick('refresh');}else if(A.refresh){A.refresh();}else if(A.grid.footer&&A.grid.footer.onClick){A.grid.footer.onClick('refresh');}else {A.grid.getDataSource().load();}},failure:function(D){A.grid.getView().mainWrap.unmask();Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["e84cbf769d01c3cf5f2470839353035a"]);}});});},refreshActivePanel:function(){var A=this.layout.getRegion('center').getActivePanel();if(A.controller&&A.controller.paging){A.controller.paging.onClick('refresh');return;}var B=Pman.layout.getRegion('center').getActivePanel().id;if(!B){return;}
Pman.Tab[B].paging.onClick('refresh');},toCidV:function(A){return 'C'+A.in_out.substring(0,1)+A.cid;},standardActionFailed:function(f,A,cb){if(A.failureType=='client'){Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["3fdc18a65a1b517a5009529425c3565b"],cb);return;}if(A.failureType=='connect'){Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["6ba73887c9a59d4caa85658209534ee8"],cb);return;}if(A.type=='submit'){Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],typeof(A.result.errorMsg)=='string'?String.format('{0}',A.result.errorMsg):_T["7aabc9f3cf1f6785a4bc4dd0f1a2a321"],cb);return;}
Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["b636c0e59d884e880fb4ca5fda048cf4"],cb);},request:function(c){var r=new Roo.data.Connection({timeout:typeof(c.timeout)=='undefined'?30000:c.timeout});r.request({url:c.url,method:c.method,params:c.params,xmlData:c.xmlData,success:function(A,B){var C=Pman.processResponse(A);if(!C.success){if(c.failure){if(true===c.failure.call(this,A,B)){return;}}
Roo.MessageBox.hide();Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],C.errorMsg?C.errorMsg:_T["7b085783b608ea949c9fb9de84016b78"]);return;}
c.success.call(this,C.data);return;},failure:function(A,B){if(c.failure){if(true===c.failure.call(this,A,B)){return;}}
Roo.MessageBox.hide();Roo.MessageBox.alert(_T["cf72aae865f3f0be736987f7dc390e25"],_T["fdf760f049c0a779ad7e88cca6dc642d"]);Roo.log(A);},scope:this});},download:function(c){return new Pman.Download(c);},downloadRevision:function(A,B){this.download({url:baseURL+'/Documents/Doc/DownloadRev/'+A.id+'/'+B+'/'+A.project_id_code+'-'+A.cidV+'-'+B+'-'+A.filename});},exportCSV:function(c){for(var i=0;i<c.csvFormat.length;i++){c.params['csvCols['+i+']']=c.csvFormat[i][0];c.params['csvTitles['+i+']']=c.csvFormat[i][1];}
c.url+='?'+Roo.urlEncode(c.params);this.download(c);},prettyDate:function(A){if(typeof(A)=='string'){var ds=Date.parseDate(A,'Y-m-d H:i:s');if(ds){return this.prettyDate(ds);}
ds=Date.parseDate(A,'Y-m-d');if(ds){return this.prettyDate(ds);}return '';}if(!A){return '';}var td=new Date();var B=Math.floor(td.getElapsed(A)/(1000*60*60*24));if(B<7){return A.dateFormat('D H:i');}if(td.dateFormat('m')==A.dateFormat('m')){return A.dateFormat('dS D');}if(td.dateFormat('Y')==A.dateFormat('Y')){return A.dateFormat('dS M');}return A.dateFormat('d M Y');},loadException:function(a,b,c,d){if(d&&d.authFailure){Pman.Login.show();return;}
Roo.MessageBox.alert(_T["4177e7e2dbe28af7f72338aaeb603afd"],a.message||c.statusText);},notifyActive:false,notifyTitle:function(A){if(this.notifyActive){return;}var B=false;var C=function(){B=true;document.title=D;};Roo.get(document.body).on('mousemove',C,this);var D=document.title;var s=1;var E=this;var F=window.setInterval(function(){if(B){Roo.get(document.body).un('mousemove',C,this);E.notifyActive=false;document.title=D;window.clearInterval(F);return true;}
s=!s;document.title=s?A:D;},1000);document.title=A;},modules:false,register:function(A){if(!A.parent){if(A.parent===false){return;}
console.log(A);}if(!A.parent.modules){A.parent.modules=new Roo.util.MixedCollection(false,function(o){return o.modKey});}
A.parent.modules.add(A);},buildModules:function(A,B){var C=this;var D=function(a,b){return String(a).toUpperCase()>String(b).toUpperCase()?1:-1;};if(!A.modules){return;}
A.modules.keySort('ASC',D);var E=[];var F=function(m){E.push(m);if(m.module.modules){m.module.modules.keySort('ASC',D);m.module.modules.each(F);}if(m.finalize){m.finalize.name=m.name+_T["afaa6ac88a5c532720f81ab8d1cf345d"];E.push(m.finalize);}}
A.modules.each(F);if(!E.length){if(B)B();return;}
Roo.MessageBox.show({title:'loading'});Roo.MessageBox.show({title:_T["1c34c8962b28be597267aef253b4694b"],msg:_T["6a4a6d2119244f74b8d02f20ef005c5e"],width:450,progress:true,closable:false,modal:false});var n=0;var G=function(){var H=E[n];Roo.MessageBox.updateProgress((n+1)/E.length,_T["51ff98c417d79325f91861af9c61cfb3"]+(n+1)+_T["da27970c3ea08e35a23fb956908b78f4"]+E.length+(H.name?(' - '+H.name):''));if(typeof(H)=='function'){H();}else if(H.parent.layout&&!H.module.disabled){if(H.permname&&H.permname.length){if(Pman.hasPerm(H.permname,'S')){H.module.add(H.parent.layout,H.region);}}else {H.module.add(H.parent.layout,H.region);}}
n++;if(n>=E.length){B();return;}
G.defer(10,Pman);}
G.defer(1,Pman);},invertColor:function(c){var ca=[];for(var i=0;i<3;i++){ca[i]=parseInt(c.charAt((i*2)+1)+c.charAt((i*2)+2),16);}var A='';Roo.each(ca,function(hi){var h=parseInt(255-hi).toString(16);if(h<16){h='0'+h;}
A+=h;});return '#'+A;}});
Pman.Lock=function(A){this.cfg=A;this.callLock();}
Roo.apply(Pman.Lock.prototype,{cfg:false,id:false,callLock:function(A){A=A||0;var _t=thisPman.Request({url:baseURL+'/Core/Lock/lock',params:{on_table:this.cfg.table,on_id:this.cfg.id,force:A},failure:function(){Roo.MessageBox.alert(_T["9f291a7145874911230d9e65522c7d88"],_T["bbdf5c921245f319be4e75705be19497"]);},success:function(B){if(!A&&typeof(B)=='object'){_t.confirmBreak(B);return;}
_t.id=B;_t.cfg.success(_t);}})},confirmBreak:function(ar){var A=_T["0a911873cb7a0fd7f0746c3a1a22dd7c"]+_T["fb9b9c03fe53aa14b7fb9e14d4cb867f"];Roo.each(ar,function(p){A+='<br/>'+p.name+' at '+p.lock_created;})var _t=this;Roo.MessageBox.confirm(_T["eb35517abbc6b827c277baeace910d36"],A,function(r){if(r!='yes'){return;}
_t.callLock(1);});},unlock:function(){Pman.Request({url:baseURL+'/Core/Lock/unlock',params:{id:this.id},failure:function(){Roo.MessageBox.alert(_T["9f291a7145874911230d9e65522c7d88"],_T["00f9887fd3da4059f843fc8a5f758871"]);},success:function(A){}});}});
Pman.Login=new Roo.util.Observable({events:{'render':true},disabled:false,dialog:false,form:false,haslogo:false,authUserId:0,authUser:{id:false},checkFails:0,versionWarn:false,sending:false,onLoad:function(){if(Roo.get('loading')){Roo.get('loading').remove();}
this.switchLang('en');Roo.Ajax.request({url:baseURL+'/Login.js',params:{getAuthUser:true},method:'GET',success:function(A,B){var C=Pman.processResponse(A);this.checkFails=0;if(!C.success){this.checkFails=5;return Pman.Login.failure(A,B);}if(!C.data.id){return this.show(true);}
this.fillAuth(C.data);this.checkFails=0;Pman.onload();return false;},failure:Pman.Login.show,scope:Pman.Login});},check:function(A){if(A){Pman.Login.checkFails++;}else {Pman.Login.checkFails=0;}var B=this;if(this.sending){if(Pman.Login.checkFails>4){Pman.Preview.disable();Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],_T["4b0bb0bd607983ab0061a86db7fc7ba2"],function(){B.sending=false;});return;}
B.check.defer(10000,B,[true]);return;}
this.sending=true;Roo.Ajax.request({url:baseURL+'/Login.js',params:{getAuthUser:true},method:'GET',success:Pman.Login.success,failure:Pman.Login.failure,scope:Pman.Login});},failure:function(A,B){this.authUser=-1;this.sending=false;var C=Pman.processResponse(A);if(Pman.Login.checkFails>2){Pman.Preview.disable();Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],C.errorMsg?C.errorMsg:_T["54242987801741c4105cfa0435d9912e"]);return;}
Pman.Login.check.defer(1000,Pman.Login,[true]);return;},success:function(A,B){this.sending=false;var C=Pman.processResponse(A);if(!C.success){return this.failure(A,B);}if(!C.data||!C.data.id){return this.failure(A,B);}
this.fillAuth(C.data);this.checkFails=0;Pman.onload();return false;},fillAuth:function(au){this.startAuthCheck();this.authUserId=au.id;this.authUser=au;this.lastChecked=new Date();Pman.fireEvent('authrefreshed',au);Roo.state.Manager.set('Pman.Login.lang.'+appNameShort,au.lang);this.switchLang(au.lang);if(this.authUserId<0){Roo.MessageBox.alert(_T["9eba57f4ad82997225a340c5c140a869"],_T["5d5717e963d28007da9511d1416cbc43"]);}},intervalID:false,lastChecked:false,startAuthCheck:function(){if(Pman.Login.intervalID){return false;}
Pman.Login.intervalID=window.setInterval(function(){Pman.Login.check(false);},120000);return true;},create:function(){if(this.dialog){return;}var A=this;this.dialog=new Roo.LayoutDialog(Roo.get(document.body).createChild({tag:'div'}),{autoCreated:true,title:_T["68156a5e398303b805bd96fbc6b1f8ee"],modal:true,width:350,height:230,shadow:true,minWidth:200,minHeight:180,closable:false,draggable:false,collapsible:false,resizable:false,center:{autoScroll:false,titlebar:false,hideTabs:true,closeOnTab:true,alwaysShowTabs:false}});this.dialog.addButton(_T["b2d0ea65f8ae06179a40d78e52b7833c"],function(){var n=A.form.findField('username').getValue();if(!n.length){Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],_T["9055d707d0388278ceb4f35426316c1b"]);return;}
Roo.Ajax.request({url:baseURL+'/Login.js',params:{passwordRequest:n},method:'POST',success:function(B,C){var D=Pman.processResponse(B);if(!D.success){Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],D.errorMsg?D.errorMsg:_T["2409934e0552cdd76753d2c11005b6b5"]);return;}
Roo.MessageBox.alert(_T["463c573d3aed3795e9e3145f10cd1416"],_T["de7b06c26e8b5361eb8e33d068dd2ce4"]);},failure:function(){Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],_T["2409934e0552cdd76753d2c11005b6b5"]);}});});this.dialog.addButton(_T["68156a5e398303b805bd96fbc6b1f8ee"],function(){Pman.Login.dialog.el.mask(_T["31cfba7708e9535c79660355d0f8accf"]);Pman.Login.form.doAction('submit',{url:baseURL+'/Login',method:'POST'});});this.layout=this.dialog.getLayout();this.layout.beginUpdate();this.form=new Roo.form.Form({labelWidth:100,listeners:{actionfailed:function(f,B){Pman.Login.dialog.el.unmask();Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],B.result.errorMsg?B.result.errorMsg:_T["c1b8242e54c06ad890a6a091195f7b8e"]);},actioncomplete:function(re,B){Roo.state.Manager.set('Pman.Login.username.'+appNameShort,Pman.Login.form.findField('username').getValue());Roo.state.Manager.set('Pman.Login.lang.'+appNameShort,Pman.Login.form.findField('lang').getValue());Pman.Login.fillAuth(B.result.data);Pman.Login.dialog.hide();if(Roo.get('loading-mask')){Roo.get('loading-mask').show();}
Pman.onload();}}});this.form.add(new Roo.form.TextField({fieldLabel:_T["7e698d4c146d9eefd5dcd10552b18098"],name:'username',width:200,autoCreate:{tag:_T["23e3b3bf16c1b9ee0b448a20cde1d8a0"],type:_T["356c052df252f5f41bf445742c4a9e92"],size:_T["e5c7255d15759b64bbee6c623c299744"]}}),new Roo.form.TextField({fieldLabel:_T["3b9a78188b115fa00e2285cd1047a02e"],inputType:'password',name:'password',width:200,autoCreate:{tag:_T["23e3b3bf16c1b9ee0b448a20cde1d8a0"],type:_T["356c052df252f5f41bf445742c4a9e92"],size:_T["e5c7255d15759b64bbee6c623c299744"]},listeners:{specialkey:function(e,ev){if(ev.keyCode==13){Pman.Login.dialog.el.mask(_T["31cfba7708e9535c79660355d0f8accf"]);Pman.Login.form.doAction('submit',{url:baseURL+'/Login.json',method:'POST'});}}}}),new Roo.form.ComboBox({fieldLabel:_T["b2a3486b5105e365dae1a1796390ba42"],name:'langdisp',store:{xtype:'SimpleStore',fields:['lang','ldisp'],data:[['en','English'],['zh_HK','\u7E41\u4E2D'],['zh_CN','\u7C21\u4E2D']]},valueField:'lang',hiddenName:'lang',width:200,displayField:'ldisp',typeAhead:false,editable:false,mode:'local',triggerAction:'all',emptyText:'Select a Language...',selectOnFocus:true,listeners:{select:function(cb,B,ix){Pman.Login.switchLang(B.data.lang);}}}));var ef=this.dialog.getLayout().getEl().createChild({tag:'div'});ef.dom.style.margin=10;this.form.render(ef.dom);Pman.Login.form.el.createChild({tag:'img',src:rootURL+'/Pman/'+appNameShort+'/templates/images/logo.gif',style:'margin-bottom: 10px;'},Pman.Login.form.el.dom.firstChild);var vp=this.dialog.getLayout().add('center',new Roo.ContentPanel(ef,{autoCreate:true,width:250,maxWidth:250,fitToFrame:true}));this.layout.endUpdate();this.fireEvent('render',this);},resizeToLogo:function(){var sz=Roo.get(Pman.Login.form.el.query('img')[0]).getSize();if(!sz){this.resizeToLogo.defer(1000,this);return;}var w=Ext.lib.Dom.getViewWidth()-100;var h=Ext.lib.Dom.getViewHeight()-100;Pman.Login.dialog.resizeTo(Math.max(350,Math.min(sz.width+30,w)),Math.min(sz.height+200,h));Pman.Login.dialog.center();},show:function(A){if(this.disabled){return;}
A=A||false;if(Pman.Login.authUserId<0){return;}if(Pman.Login.intervalID){window.clearInterval(Pman.Login.intervalID);Pman.Login.intervalID=false;}
this.create();if(Roo.get('loading')){Roo.get('loading').remove();}if(Roo.get('loading-mask')){Roo.get('loading-mask').hide();}
this.form.reset();this.dialog.modal=!A;this.dialog.show();this.dialog.el.unmask();this.resizeToLogo.defer(1000,this);this.form.setValues({'username':Roo.state.Manager.get('Pman.Login.username.'+appNameShort,''),'lang':Roo.state.Manager.get('Pman.Login.lang.'+appNameShort,'en')});Pman.Login.switchLang(Roo.state.Manager.get('Pman.Login.lang.'+appNameShort,''));if(this.form.findField('username').getValue().length>0){this.form.findField('password').focus();}else {this.form.findField('username').focus();}},logout:function(){window.onbeforeunload=function(){};Pman.Login.authUserId=-1;Roo.Ajax.request({url:baseURL+'/Login.html',params:{logout:1},method:'GET',failure:function(){Roo.MessageBox.alert(_T["8391d964e04c0c30d9f19bf036136c8d"],_T["b9f8e134e8143020e2eb596292c7c1d1"],function(){document.location=baseURL+'?ts='+Math.random();});},success:function(){Pman.Login.authUserId=-1;Pman.Login.checkFails=0;document.location=baseURL+'?ts='+Math.random();}});},switchLang:function(A){if(!A||!A.length){return;}if(typeof(_T.en)=='undefined'){_T.en={};Roo.apply(_T.en,_T);}if(typeof(_T[A])=='undefined'){Roo.MessageBox.alert(_T["20f52c7354a3fd19843e600c53121d94"],_T["1ba0950dff36aebd0c55f3b195edcb11"]+A+')');return;}
Roo.apply(_T,_T[A]);if(this.form){function formLabel(B,C){var D=Pman.Login.form.findField(B).el.dom.parentNode.parentNode;if(D.getElementsByTagName('label').length){D=D.getElementsByTagName('label')[0];}else {D=D.parentNode.getElementsByTagName('label')[0];}
D.innerHTML=C;}
formLabel('password',_T["3b9a78188b115fa00e2285cd1047a02e"]+':');formLabel('username',_T["7e698d4c146d9eefd5dcd10552b18098"]+':');formLabel('lang',_T["b2a3486b5105e365dae1a1796390ba42"]+':');this.dialog.setTitle(_T["68156a5e398303b805bd96fbc6b1f8ee"]);this.dialog.buttons[0].setText(_T["b2d0ea65f8ae06179a40d78e52b7833c"]);this.dialog.buttons[1].setText(_T["68156a5e398303b805bd96fbc6b1f8ee"]);}},inGroup:function(g){return this.authUser&&this.authUser.groups&&this.authUser.groups.indexOf(g)>-1;},isOwner:function(){return this.authUser&&this.authUser.company_id_comptype&&this.authUser.company_id_comptype=='OWNER';},i18nList:function(A,B){return Pman.I18n.listToNames(A,B);},i18n:function(A,B){return Pman.I18n.toName(A,B);}});
Pman.PasswordChange={dialog:false,form:false,create:function(){if(this.dialog){return;}var A=this;this.dialog=new Ext.LayoutDialog(Ext.get(document.body).createChild({tag:'div'}),{autoCreated:true,title:_T["eadd75daa6471a87eb75121dd5eab06a"],modal:true,width:500,height:160,shadow:true,resizable:false,closable:false,draggable:false,center:{autoScroll:false,titlebar:false,hideTabs:true,closeOnTab:true,alwaysShowTabs:false}});var B=function(C){Pman.Preview.tmpEnable();A.dialog.hide();if(A.callback){A.callback.call(this,C?C:false);}};this.dialog.addKeyListener(27,B,this);this.dialog.addButton(_T["9b6839c225da5cb93c3bf29720e0531d"],B,this);this.dialog.addButton(_T["f7c61a97b669d7f5128b51c8644c400c"],this.save,this);this.layout=this.dialog.getLayout();this.layout.beginUpdate();this.form=new Ext.form.Form({labelWidth:220,listeners:{actionfailed:function(f,C){A.dialog.el.unmask();if(C.failureType=='client'){Ext.MessageBox.alert(_T["db88368227b739ed12b165005f43d2c9"],_T["23b47796783d663d3113bde8469f9202"]);return;}if(C.type=='submit'){Ext.MessageBox.alert(_T["db88368227b739ed12b165005f43d2c9"],typeof(C.result.errorMsg)=='string'?C.result.errorMsg:_T["25092a9a028d282401e526d9252c734d"]);return;}
Ext.MessageBox.alert(_T["db88368227b739ed12b165005f43d2c9"],_T["39b3f1da7208ad35ea991d47bb460b30"]);},actioncomplete:function(f,C){A.dialog.el.unmask();if(C.type=='submit'){B(C.data);return;}}}});this.form.addxtype.apply(this.form,[{name:'passwd1',fieldLabel:_T["1b6ed9a99ae0f49a874fab476d0e70c4"],value:'',allowBlank:false,inputType:'password',xtype:'SecurePass',width:220,imageRoot:rootURL+'/Pman/templates/images'},{name:'passwd2',fieldLabel:_T["6f52a45578b8376c688a75ddc7888122"],value:'',allowBlank:false,inputType:'password',xtype:'TextField',width:220},{name:'passwordReset',value:'',xtype:'Hidden'}]);var ef=this.dialog.getLayout().getEl().createChild({tag:'div'});ef.dom.style.margin=10;this.form.render(ef.dom);var vp=this.dialog.getLayout().add('center',new Ext.ContentPanel(ef,{autoCreate:true,width:250,maxWidth:250,fitToFrame:true}));this.layout.endUpdate();},_id:0,show:function(A,B){this.callback=B;this.data=A;this.create();this.form.reset();this.form.setValues(A);Pman.Preview.tmpDisable();this.dialog.show();this.form.findField('passwd1').focus();},save:function(){var p1=this.form.findField('passwd1').getValue();var p2=this.form.findField('passwd2').getValue();if(!p1.length||!p2.length){Ext.MessageBox.alert(_T["db88368227b739ed12b165005f43d2c9"],_T["78a7430d961bec5b3d4759206ebc2b04"]);}if(p1!=p2){Ext.MessageBox.alert(_T["db88368227b739ed12b165005f43d2c9"],_T["a217bd43e7427e981bc8dbf18998faed"]);}
this.form.doAction('submit',{url:baseURL+'/Login.html',method:'POST',params:{changePassword:true,ts:Math.random()}});}}
Pman.Preview={frame:false,pdf:false,imgDiv:false,active:false,init:function(){if(this.frame){return;}if(Roo.isGecko){this.pdf=Ext.DomHelper.append(document.body,{id:'pdf-view',tag:'object',type:'application/pdf',data:'about:blank',width:200,height:200,style:'position:absolute;top:-1000;left:-1000; z-index:-100',cn:[{tag:'param',name:'src',value:'about:blank'}]},false);}
this.imgDiv=Ext.DomHelper.append(document.body,{tag:'div',style:'position:absolute;top:-1000;left:-1000; z-index:-100;'+'overflow-x:hidden;overflow-y:scroll;width:200px; height: 200px;'});this.frame=Ext.DomHelper.append(document.body,{tag:'iframe',src:'about:blank',style:'position:absolute;top:-1000;left:-1000; z-index:-100;'+'width:1px; height: 1px;'});},config:false,onResize:function(){if(this.active){this.active.style.zIndex=this.activeCfg?this.activeCfg.zIndex:-100;}if(!this.config.previewRegion){return;}var A=this.config.previewRegion.el.getBox();if(A.width<10){return;}if(!this.active){return;}
this.active.setAttribute('width',A.width);this.active.setAttribute('height',A.height);this.active.style.width=A.width+'px';this.active.style.height=A.height+'px';this.active.style.top=A.y+'px';this.active.style.left=A.x+'px';},unlink:function(){if(!this.config){return;}if(this.config.dialog){this.config.dialog.un('hide',this.onHide,this);}if(this.config.tab){this.config.tab.un('deactivate',this.onHide,this);}
this.config.previewRegion.un('resized',this.onResize,this);this.config=false;},link:function(A){this.init();if(this.config){this.unlink();}
this.config=A;if(this.config.dialog){this.config.dialog.on('hide',this.onHide,this);}if(this.config.tab){this.config.tab.on('deactivate',this.onHide,this);}
this.config.previewRegion.on('resized',this.onResize,this);},removeActive:function(){if(!this.active){return;}
this.active.style.left='-1000px';this.active.style.top='-1000px';this.active.style.width='200px';this.active.style.top='200px';this.active.style.zIndex=-100;this.active=false;},onHide:function(){if(!this.active){return;}
this.removeActive();this.unlink();},showPdf:function(){this.removeActive();this.activeCfg.url=this.activeCfg.pdfurl;this.activeCfg.mimetype='application/pdf';this.load(this.activeCfg);},load:function(A){this.activeCfg=false;if(typeof(A)!='object'){alert('Preview Load only accepts object with url/mimetype/zIndex as loader');return;}
this.activeCfg=Roo.apply({},A);var B=this.activeCfg.url;var C=this.activeCfg.mimetype;this.removeActive();switch(C){case 'image/jpeg':var ps=this.config.previewRegion.el.getBox();this.imgDiv.innerHTML='<img src="'+B+'"'+' width="'+(ps.width-15)+'"'+' qtip="'+_T["e4fe205ae80b87b90434e12e5e3a4c9b"]+'"'+' ext:width="100"'+' onclick="Pman.Preview.showPdf();"/>';this.active=this.imgDiv;this.enable(this.activeCfg.zIndex);return;break;case 'application/pdf':case 'application/msword':case 'application/vnd.oasis.opendocument.text':case 'application/vnd.ms-excel':case 'application/vnd.oasis.opendocument.spreadsheet':case 'application/vnd.dwg':case 'application/acad':case 'application/x-acad':case 'application/autocad_dwg':case 'image/x-dwg':case 'application/dwg':case 'application/x-dwg':case 'application/x-autocad':case 'image/vnd.dwg':case 'drawing/dwg':if(!B.match(/\.pdf$/)){B+='.pdf';}if(!Roo.isGecko){this.frame.src=B;this.active=this.frame;this.enable(this.activeCfg.zIndex);return;}
this.pdf.setAttribute('data',B);this.active=this.pdf;this.enable(this.activeCfg.zIndex);return;default:this.frame.src=B;this.active=this.frame;this.enable(this.activeCfg.zIndex);return;}},disable:function(){if(!this.active){return;}
this.disabled=true;this.active.style.zIndex=-100;if(!Roo.isGecko){this.frame.src='about:blank';}},enable:function(A){if(!this.active){return;}
this.disabled=false;this.active.style.zIndex=A?A:10000;if(!Roo.isGecko&&this.activeCfg){this.frame.src=this.activeCfg.url;}
this.onResize();},tmpStatus:false,tmpDisable:function(){if(this.disabled){this.tmpStatus=false;return;}
this.tmpStatus=true;this.disable();},tmpEnable:function(){if(!this.tmpStatus){return;}
this.tmpStatus=false;this.enable();}}
Pman.Request=function(A){Pman.Request.superclass.constructor.call(this,A);this.request(A);if(this.mask&&this.maskEl){Roo.get(this.maskEl).mask(this.mask);}}
Roo.extend(Pman.Request,Roo.data.Connection,{processResponse:function(A){var B;try{B=Roo.decode(A.responseText);if(typeof(B)!='object'){B={success:false,errorMsg:B,errors:true};}if(typeof(B.success)=='undefined'){B.success=false;}}catch(e){res={success:false,errorMsg:response.responseText||Roo.encode(response),errors:true};}if(!B.success&&!B.errorMsg){B.errorMsg=Roo.encode(A);}return B;},handleResponse:function(A){this.transId=false;var B=A.argument.options;A.argument=B?B.argument:null;this.fireEvent(_T["e514ef4c66a523c2440a2225a81f1e79"],this,A,B);if(this.mask&&this.maskEl){Roo.get(this.maskEl).unmask();}var C=this.processResponse(A);if(!C.success){if(B.failure){if(true===Roo.callback(B.failure,B.scope,[C,B])){return;}}
Roo.MessageBox.hide();Roo.MessageBox.alert(_T["c2868ee15182a3ad88334a8025b58188"],C&&C.errorMsg?C.errorMsg:_T["b7c7cfdbed677c3822a46abcf1f9138a"]);return;}
Roo.callback(B.success,B.scope,[C,B]);},handleFailure:function(A,e){this.transId=false;var B=A.argument.options;A.argument=B?B.argument:null;this.fireEvent(_T["7e46ce4689f1051b8c101488de4bced6"],this,A,B,e);var C=Roo.callback(B.failure,B.scope,[A,B]);if(this.mask&&this.maskEl){Roo.get(this.maskEl).unmask();}if(C!==true){var D=this.processResponse(A);Roo.log(D);Roo.MessageBox.hide();Roo.MessageBox.alert(_T["c2868ee15182a3ad88334a8025b58188"],D&&D.errorMsg?D.errorMsg:_T["b7c7cfdbed677c3822a46abcf1f9138a"]);}}});
Pman.Std={project_id:function(A){A=A||{};A.storeListeners=A.storeListeners||{};return Roo.apply({width:200,fieldLabel:_T["e82288f1b4eba83e3912993b59e9874c"],name:'project_id_code',hiddenName:'project_id',allowBlank:false,selectOnFocus:true,qtip:_T["8e24b2c00ecb83fdbedee6634dbe7a6e"],xtype:'ComboBox',store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Projects.html',method:'GET'},reader:Pman.Readers.Projects,listeners:Roo.apply({loadexception:Pman.loadException},A.storeListeners),remoteSort:true,sortInfo:{field:'code',direction:'ASC'}},displayField:'code',valueField:'id',typeAhead:true,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','<b>{code}</b> {name}','</div>'),queryParam:'query[project_search]',loadingText:_T["dacaeb74293d8e9bb58c28681b02c321"],listWidth:400,minChars:2,pageSize:20},A);},company_id:function(A){A=A||{};A.storeListeners=A.storeListeners||{};A.listeners=A.listeners||{};return Roo.apply({name:'addressto_name',displayField:'name',fieldLabel:_T["993475eb7faf2229459aa6ca1c3745e9"],allowBlank:true,qtip:_T["f7e6a2016c5b5f0113b18708d84db782"],width:290,value:'',xtype:'ComboBoxAdder',selectOnFocus:true,allowBlank:false,store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Companies.html',method:'GET'},reader:Pman.Readers.Companies,listeners:Roo.apply({loadexception:Pman.loadException},A.storeListeners),remoteSort:true,sortInfo:{field:'name',direction:'ASC'}},typeAhead:true,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','<b>{name}</b> {address}','</div>'),queryParam:'query[name]',loadingText:_T["dacaeb74293d8e9bb58c28681b02c321"],listWidth:400,minChars:2,pageSize:20},A);},doctype_name:function(A){A=A||{};return Roo.apply({name:'doctype_name',width:290,fieldLabel:_T["adaa177b337c92793900a09979b7644f"],allowBlank:false,qtip:_T["f3ae3d381d60864b13244e2ac16c12fe"],value:'',xtype:'ComboBox',store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Document_Types.html',method:'GET'},reader:Pman.Readers.Document_Types,listeners:{beforeload:function(t,o){o.params.limit=9999;},loadexception:Pman.loadException},remoteSort:true,sortInfo:{field:'name',direction:'ASC'}},displayField:'name',typeAhead:false,editable:false,triggerAction:'all',selectOnFocus:true},A);},address_list_adder:function(A){A=A||{};A.storeListeners=A.storeListeners||{};return Roo.apply({name:'send_to',fieldLabel:_T["f6551e5409cd0bd1293c73466c0d5a71"],idField:'email',renderer:function(d){return String.format('{0}',d.name.length?d.name:d.email);},xtype:'ComboBoxLister',displayField:'name',value:'',qtip:_T["397925800f038e68f28adacc0c39d6ca"],selectOnFocus:true,allowBlank:true,width:150,store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Person.html',method:'GET'},reader:Pman.Readers.Companies,listeners:A.storeListeners,remoteSort:true,sortInfo:{field:'name',direction:'ASC'}},typeAhead:true,forceSelection:true,triggerAction:'all',tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','<b>{name}</b> {email}','</div>'),queryParam:'query[name]',loadingText:_T["dacaeb74293d8e9bb58c28681b02c321"],listWidth:400,minChars:2,pageSize:20,setList:function(ar){var B=this;Roo.each(ar,function(a){B.addItem(a);});},toList:function(){var B=[];this.items.each(function(a){B.push(a.data);});return B;}},A);},our_office_id:function(A){A=A||{};A.listeners=A.listeners||{};return Roo.apply({xtype:'ComboBoxAdder',fieldLabel:_T["964610e35dbc2d5e2ef34f1492eff1c7"],hiddenName:'office_id',name:'office_id_name',qtip:_T["2b617d7e2e8fdfe8fee08f5086f6e7b7"],width:300,allowBlank:true,triggerAction:'all',typeAhead:true,forceSelection:true,selectOnFocus:true,displayField:'name',valueField:'id',store:{xtype:'Store',proxy:{xtype:'HttpProxy',url:baseURL+'/Roo/Office.html',method:'GET'},reader:Pman.Readers.Office,listeners:Roo.apply({loadexception:Pman.loadException},A.storeListeners),remoteSort:true,sortInfo:{field:'name',direction:'ASC'}},listeners:Roo.apply({adderclick:function(){var B={company_id:Pman.Login.authUser.company_id*1,company_id_name:Pman.Login.authUser.company_id_name,address:'',phone:'',fax:'',email:''};Pman.Preview.tmpDisable();Pman.Dialog.Office.show(B,function(C){_this.setFromData(C);Pman.Preview.tmpEnable();});}},A.listeners),tpl:new Ext.Template('<div class="x-grid-cell-text x-btn button">','<b>{name}</b> {address}','</div>'),queryParam:'query[name]',loadingText:_T["dacaeb74293d8e9bb58c28681b02c321"],listWidth:400,minChars:2,pageSize:20},A);},country:function(A){return Pman.I18n.country(A);},language:function(A){return Pman.I18n.language(A);},languageList:function(A){return Pman.I18n.languageList(A);},countryList:function(A){return Pman.I18n.countryList(A);}};
Pman.Tab.GroupsList=function(A){Ext.apply(this,A);};Pman.Tab.GroupsList.prototype={id:false,grid:false,panel:false,getDialog:false,title:false,type:0,disabled:false,add:function(A,B){var C=this;var D=function(){C.refresh();};if(this.panel){A.getRegion(B).showPanel(this.panel);return;}var refreshCenterPanel=function(){var H=A.getRegion('center').getActivePanel();if(H&&H.controller){H.controller.refresh();return;}var I=H.id;if(!I){return;}
Pman.Tab[I].refresh();};var frm=A.getRegion(B).getEl().createChild({tag:'div'});this.grid=new Ext.grid.Grid(frm,{id:C.id+'-groups',enableDrop:true,ddGroup:'groupDD',ds:new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:baseURL+'/Roo/Groups.html',method:'GET'}),remoteSort:true,reader:Pman.Readers.Groups,sortInfo:{field:'name',direction:'ASC'},listeners:{beforeload:function(t,o){if(!o.params){o.params={};}
o.params.type=C.type;},load:function(){var sm=C.grid.getSelectionModel();if(!sm.getSelections().length){sm.selectFirstRow();}
refreshCenterPanel();},loadexception:Pman.loadException}}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),cm:new Ext.grid.ColumnModel([{id:C.id+'-name',header:_T["45e376f384cdb1f67a866700b892b3e8"],dataIndex:'name',sortable:true,width:100,renderer:function(v,x,r){if(r.data.id==-1){return '<b>'+_T["d5cd30d9a8889de9ad91d34e09da494b"]+'</b>';}if((r.data.id==0)&&(C.type==0)){return '<b>'+_T["8b2b7b9a1be82d2550e1d2bf71504f40"]+'</b>';}if((r.data.id==0)&&(C.type==2)){return '<b>'+_T["0534e1944a96427d47b562c494d85447"]+'</b>';}if(r.data.id==0){return '<b>'+_T["0b0e4ee0b6875cbaa307a8d7f3c3d7ee"]+'</b>';}if(v=='Administrators'){return '<b>'+_T["b9b270f938cabca10640a932c830a4ce"]+'</b>';}if(r.data.leader){return v+' ('+r.data.leader_name+')';}return v;}}]),autoExpandColumn:C.id+'-name',clicksToEdit:1,loadMask:true,listeners:{rowclick:function(g,ri,e){refreshCenterPanel();}}});this.panel=A.add(B,new Ext.GridPanel(this.grid,{fitToframe:true,fitContainer:true,title:C.title,id:C.id,background:true}));this.grid.render();new Ext.dd.DropTarget(C.grid.getView().mainBody,{ddGroup:'groupDD',copy:true,notifyOver:function(dd,e,H){var t=Roo.lib.Event.getTarget(e);var ri=C.grid.view.findRowIndex(t);var I=false;if(ri!==false){I=C.grid.getDataSource().getAt(ri).data;}var s=C.grid.getSelectionModel().getSelections();var J=s.length?s[0].data.id>0:false;var K=I&&I.id>0;if(J&&K){return this.dropNotAllowed;}if(!J&&!K){return this.dropNotAllowed;}if(J&&!K){return 'x-dd-drop-ok-sub';}return 'x-dd-drop-ok-add';},notifyDrop:function(dd,e,H){var t=Roo.lib.Event.getTarget(e);var ri=C.grid.view.findRowIndex(t);var I=false;if(ri!==false){I=C.grid.getDataSource().getAt(ri).data;}var s=C.grid.getSelectionModel().getSelections();var J=s.length?s[0].data.id>0:false;var K=I&&I.id>0;if(J&&K){return false;}if(!J&&!K){return false;}var L='add';if(J&&!K){L='sub';}var M=[];for(var i=0;i<H.selections.length;i++){M.push(H.selections[i].data.id);}
Pman.request({url:baseURL+'/Core/GroupMembers.php',params:{action:L,group_id:L=='add'?I.id:s[0].data.id,type:C.type,user_ids:M.join(',')},method:'POST',success:function(N){D();},failure:function(){}});return true;}});var E=this.grid;var F=this.grid.getView().getHeaderPanel(true);this.toolbar=new Ext.Toolbar(F);var G=this.getDialog();this.toolbar.add({text:_T["982d7a1e24433e552a3d694a095f053e"],cls:'x-btn-text-icon',icon:Ext.rootURL+'images/default/tree/leaf.gif',menu:{items:[{text:_T["0f65f59038860dbf03201afab99fe7e1"],cls:'x-btn-text-icon',icon:Ext.rootURL+'images/default/dd/drop-add.gif',hidden:!Pman.hasPerm('Core.Groups','A'),handler:function(){G.show({id:0,type:C.type},D);}},{text:_T["0537a153a0e54447d83d2c8d094a03d1"],cls:'x-btn-text-icon',icon:Ext.rootURL+'images/default/tree/leaf.gif',hidden:!Pman.hasPerm('Core.Groups','E'),handler:function(){var s=E.getSelectionModel().getSelections();if(!s.length||(s.length>1)){Ext.MessageBox.alert(_T["081fcfe0460716e500eeab497d45d6b8"],s.length?_T["f845801a4be23199251c41e1c2ac5e98"]:_T["178044591ed0652d2b82b7f7eb90b22a"]);return;}if((s[0].data.name=='Administrators')||(s[0].data.name=='Default')){Ext.MessageBox.alert(_T["081fcfe0460716e500eeab497d45d6b8"],_T["075c26b58d3827f7726bb1eb7c2d13dc"]);return;}if(s.data.id<1){Ext.MessageBox.alert(_T["081fcfe0460716e500eeab497d45d6b8"],_T["075c26b58d3827f7726bb1eb7c2d13dc"]);return;}
G.show(s[0].data,D);}},{text:_T["1eeb327bd294d207da46d9cfb93f9042"],cls:'x-btn-text-icon',icon:rootURL+'/Pman/templates/images/trash.gif',hidden:!Pman.hasPerm('Core.Groups','D'),handler:function(){var s=E.getSelectionModel().getSelections();for(var i=0;i<s.length;i++){if((s[i].data.id<1)||(s[i].data.name=='Administrators')){Ext.MessageBox.alert(_T["081fcfe0460716e500eeab497d45d6b8"],_T["2d481b48a578e9122e0cda91604a73b1"]);return;}}
Pman.genericDelete(C,'Groups');}},'-',{text:_T["726e57af6b8966adfdcaa385105de4d1"],cls:'x-btn-text-icon',icon:rootURL+'/Pman/templates/images/view-refresh.gif',handler:function(){D();}}]}});this.panel.on('activate',function(){});},refresh:function(){this.grid.getDataSource().reload();}};
Pman.Tab.PersonList=function(A){Roo.apply(this,A);}
Pman.Tab.PersonList.prototype={id:'',type:0,title:false,hiddenColumns:false,itemDisplayName:false,permName:'Core.Person',getLeftSelections:function(){return [];},hideDelete:false,beforeload:function(t,o){alert('person list not configured');return false;},columns:function(){alert('person list not configured');return false;return [this.c_name(),this.c_office_id_name(),this.c_role(),this.c_phone(),this.c_fax(),this.c_email(),this.c_active()]},dialog:function(){alert('person list not configured');return false;return Pman.Dialog.PersonStaff;},bulkAdd:function(){return false;},newDefaults:function(){alert('person list not configured');return false;return {id:0,company_id:Pman.Login.authUser.company_id,company_id_name:Pman.Login.authUser.company_id_name,company_id_address:Pman.Login.authUser.company_id_address,company_id_tel:Pman.Login.authUser.company_id_tel,company_id_fax:Pman.Login.authUser.company_id_fax};},parentLayout:false,showInActive:0,grid:false,panel:false,toolbar:false,paging:false,tab:false,refreshWestPanel:function(){var A=this.parentLayout.getRegion('west').getActivePanel();if(A&&A.controller){A.controller.paging.onClick('refresh');return;}if(!A||!A.id){return;}
Pman.Tab[A.id].refresh();},refresh:function(){if(!this.paging){this.delayedCreate();}
this.paging.onClick('refresh');},loadFirst:function(){if(!this.paging){this.delayedCreate();}
this.paging.onClick('first');},add:function(A,B){var C=this;if(this.tab){A.getRegion(B).showPanel(this.panel);return;}
this.parentLayout=A;this.layout=new Roo.BorderLayout(A.getEl().createChild({tag:'div'}),{center:{autoScroll:true,hideTabs:true}});this.tab=A.add(B,new Roo.NestedLayoutPanel(this.layout,{title:this.title,background:true,controller:this}));this.tab.on('activate',function(){C.delayedCreate();});},delayedCreate:function(){var A=this;if(this.grid){return;}var B=function(){A.refresh();}
this.layout.beginUpdate();var C=this.layout.getRegion('center').getEl().createChild({tag:'div'});this.grid=new Roo.grid.Grid(C,{ddGroup:'groupDD',enableDrag:true,id:this.id+'-grid',ds:new Roo.data.Store({proxy:new Roo.data.HttpProxy({url:baseURL+'/Roo/Person.html',method:'GET'}),reader:Pman.Readers.Person,remoteSort:true,listeners:{beforeload:function(t,o){return A.beforeload(t,o);},loadexception:Pman.loadException,update:function(F,G,H){if(H!='commit'){return;}new Pman.Request({url:baseURL+'/Roo/Person.php',method:'POST',params:{id:G.data.id,active:G.data.active},success:function(){},failure:function(){Roo.MessageBox.alert(_T["bf5c8b4410513986dffc6d6d6f025c5f"],_T["47d8cbe0203a795d8795f527c887fd48"],function(){A.grid.footer.onClick('first');});}});}},sortInfo:{field:'name',direction:'ASC'}}),cm:new Roo.grid.ColumnModel(this.columns()),autoExpandColumn:'name',clicksToEdit:1,loadMask:true,listeners:{rowdblclick:function(g,ri,e){var s=g.getDataSource().getAt(ri).data;if(A.dialog()&&Pman.hasPerm(A.permName,'E')){A.dialog().show(s,B);}},cellclick:function(F,G,H,e){var di=this.colModel.getDataIndex(H);if(di!='active'){return;}var I=A.grid.ds.getAt(G);I.set('active',I.data.active?0:1);I.commit();}}});this.panel=this.layout.add('center',new Roo.GridPanel(this.grid,{fitToframe:true,fitContainer:true,id:this.id,title:this.title||_T["25310235b726d71d9d0bc2fc903b9a3b"],controller:this}));this.grid.render();if(this.hiddenColumns){var cm=this.grid.getColumnModel();Roo.each(this.hiddenColumns,function(c){cm.setHidden(cm.getIndexByDataIndex(c),true);});}var D=this.grid.getView().getFooterPanel(true);this.paging=new Roo.PagingToolbar(D,this.grid.getDataSource(),{pageSize:25,displayInfo:true,displayMsg:_T["4788be05034a6a24e08add98ed12fddf"]+(this.itemDisplayName||_T["25310235b726d71d9d0bc2fc903b9a3b"])+_T["0a1ea6b8f312884c024a49ea271b6330"],emptyMsg:_T["f405b2cca36f62eb81fa563a0b7406ac"]+(this.itemDisplayName||_T["25310235b726d71d9d0bc2fc903b9a3b"])+_T["7bca1e8820519d2993ebabfa434007c9"]});var E=this.grid;this.toolbar=new Roo.Toolbar(this.grid.getView().getHeaderPanel(true));var tb=this.toolbar;if(this.parentLayout.getRegion('west')&&this.parentLayout.getRegion('west').panels.length){this.paging.add('<b><i><font color="red">'+(this.type?_T["469845eeeb8c7f2983a5fc6550af4dc7"]:_T["d559132c96908612dd66163dbd532812"])+'</font></i></b>');}var A=this;this.paging.add('-',{text:_T["40c16e64d6bf564aa75d2287d06c9a7b"],pressed:false,enableToggle:true,toggleHandler:function(F,G){A.showInActive=(G?1:0);F.setText(G?_T["2bcbf24c822c1428b849349709d432b4"]:_T["40c16e64d6bf564aa75d2287d06c9a7b"]);B();}},'-');this.searchBox=new Roo.form.TextField({name:'search',width:135,listeners:{specialkey:function(f,e){if(e.getKey()==13){B();}}}});var dg=A.dialog();tb.add({text:_T["39c8bb31d465dfc147324be427ace5e9"],cls:'x-btn-text-icon',icon:Roo.rootURL+'images/default/dd/drop-add.gif',hidden:!dg||(A.newDefaults()===false)||!Pman.hasPerm(this.permName,'A'),handler:function(){dg.show(A.newDefaults(),B);}},{text:_T["a89b59994ae0fe49d108d3e22d68a8f3"],cls:'x-btn-text-icon',icon:Roo.rootURL+'images/default/dd/drop-add.gif',hidden:!this.bulkAdd()||!Pman.hasPerm(this.permName,'A'),handler:function(){A.bulkAdd().show({id:0},B);}},{text:_T["d1ff8ffcb0bc971614aef7c0b5a07290"],cls:'x-btn-text-icon',icon:Roo.rootURL+'images/default/tree/leaf.gif',hidden:!dg||!Pman.hasPerm(this.permName,'E'),handler:function(){var s=E.getSelectionModel().getSelections();if(!s.length||(s.length>1)){Roo.MessageBox.alert(_T["bf5c8b4410513986dffc6d6d6f025c5f"],s.length?_T["8d7a86f0b9a3f7f52e7b49206b42f1ff"]:_T["f8eeb7a5fd0bed49c85e3664518a5e7c"]);return;}
dg.show(s[0].data,B);}},{text:_T["1984cf10277dee6c3ff92d27c3b05493"],cls:'x-btn-text-icon',hidden:!Pman.hasPerm(A.permName,'D'),icon:rootURL+'/Pman/templates/images/trash.gif',handler:function(){Pman.genericDelete(A,'Person');}},'-','Search: ',this.searchBox,{icon:rootURL+'/Pman/templates/images/search.gif',cls:'x-btn-icon',qtip:_T["f128b31c31b3754f5792d2eefdca21d0"],handler:function(){A.grid.getSelectionModel().clearSelections();B();}},{icon:rootURL+'/Pman/templates/images/edit-clear.gif',cls:'x-btn-icon',qtip:_T["87472631093f63c722db73519eb9e4b9"],handler:function(){A.searchBox.setValue('');A.grid.getSelectionModel().clearSelections();B();}},'-',{xtype:'Button',xns:Roo.Toolbar,text:_T["4ee93d3a9b0ad4e3d7c9715890b8e874"],hidden:A.permName!='Core.Staff'||!Pman.hasPerm('Core.Staff','E'),listeners:{click:function(){var s=E.getSelectionModel().getSelections();if(s.length!=1){Roo.MessageBox.alert(_T["bf5c8b4410513986dffc6d6d6f025c5f"],_T["2df7f27ebdadf94c09399420535503a9"]);return;}new Pman.Request({url:baseURL+'/Login.php',params:{'switch':s[0].data.id},method:'GET',success:function(){document.location=baseURL+'?ts='+Math.random();},failure:function(d){Roo.log(d);Roo.MessageBox.alert(_T["bf5c8b4410513986dffc6d6d6f025c5f"],d);}});}}});this.layout.endUpdate();},c_project_id_code:function(A){A=A||{};return Roo.apply({header:_T["4d49b66bbfd392f5307e93c277054732"],dataIndex:'project_id_code',sortable:false,width:70,renderer:function(v,x,r){return String.format('<span qtip="{0}">{1}</span>',r.data.action_type,v);}},A);},c_name:function(A){A=A||{};return Roo.apply({header:_T["aacd489f97738135f87d1c85be64536b"],dataIndex:'name',sortable:true},A);},c_company_id_comptype:function(A){A=A||{};return Roo.apply({header:_T["bd87244321a326daa26695ab4b721c7c"],dataIndex:'company_id_comptype',sortable:true,width:70},A);},c_company_id_name:function(A){A=A||{};return Roo.apply({header:_T["60c647263578176b102261a5ae1004a6"],dataIndex:'company_id_name',sortable:true,width:150,renderer:function(v,x,r){return String.format('{0}{1}{2}',v,r.data.office_id?' / ':'',r.data.office_id_name);}},A);},c_office_id_name:function(A){A=A||{};return Roo.apply({header:_T["3bb13cf053c9459ba5f2bad62a2e208b"],dataIndex:'office_id_name',sortable:true,width:150},A);},c_role:function(A){A=A||{};return Roo.apply({header:_T["118585dae50b38d2079b28afa5d768d6"],dataIndex:'role',sortable:true,width:100},A);},c_phone:function(A){A=A||{};return Roo.apply({header:_T["0bfc17408bdeecfce4652e09c3b90621"],dataIndex:'phone',sortable:true,width:70},A);},c_fax:function(A){A=A||{};return Roo.apply({header:_T["1ee4e8e2d1859ff63a7b58f29505249f"],dataIndex:'fax',sortable:true,width:70},A);},c_email:function(A){A=A||{};return Roo.apply({header:_T["42fcc3face9df26268d1c2bf30dcd747"],dataIndex:'email',sortable:true,width:150,renderer:function(v){return (v.length&&v.indexOf('@')>0)?String.format('<a href="mailto:{0}">{0}</a>',v):v;}},A);},c_active:function(A){A=A||{};return Roo.apply({header:_T["54bf9f5699148960b91086f351cf159e"],dataIndex:'active',sortable:true,width:50,renderer:function(v){var B=v>0?'-checked':'';return '<img class="x-grid-check-icon'+B+'" src="'+Roo.BLANK_IMAGE_URL+'"/>';}},A);}};
